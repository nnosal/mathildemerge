<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF16">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz-02-Presentation-de-la-Gestion-de-la-Paie</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Styles de base pour le corps de la page */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #dbeafe; /* Fond bleu tr√®s clair (Tailwind blue-50) */
            color: #333; /* Texte fonc√© par d√©faut pour le mode clair */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh; /* Hauteur minimale de la fen√™tre */
            padding: 20px;
            box-sizing: border-box;
            transition: background-color 0.3s ease, color 0.3s ease; /* Transition douce pour le changement de th√®me */
        }

        /* Styles du mode sombre */
        body.dark-mode {
            background-color: #1a202c; /* Fond gris fonc√© */
            color: #e2e8f0; /* Texte clair pour le mode sombre */
        }
        body.dark-mode .quiz-container {
            background-color: #2d3748; /* Gris plus fonc√© pour le conteneur */
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }
        body.dark-mode .question-text {
            color: #e2e8f0; /* Assure que le texte de la question est clair en mode sombre */
        }
        body.dark-mode .answer-option {
            background-color: #4a5568;
            color: #e2e8f0; /* Assure que le texte de l'option est clair en mode sombre */
        }
        body.dark-mode .answer-option:hover {
            background-color: #616e7f;
        }
        body.dark-mode .answer-option.correct {
            background-color: #2c5282; /* Bleu plus fonc√© */
            border-color: #4299e1;
        }
        body.dark-mode .answer-option.incorrect {
            background-color: #805ad5; /* Rose/violet plus fonc√© */
            border-color: #d6bcfa;
        }
        body.dark-mode .answer-option.selected {
            background-color: #d69e2e; /* Jaune plus fonc√© */
            border-color: #f6e05e;
        }
        body.dark-mode .rationale {
            background-color: #4a5568;
            color: #e2e8f0;
            border-left-color: #63b3ed;
        }
        body.dark-mode .rationale.correct-rationale {
            background-color: #2c5282;
            border-left-color: #4299e1;
        }
        body.dark-mode .rationale.incorrect-rationale {
            background-color: #805ad5;
            border-left-color: #d6bcfa;
        }
        body.dark-mode .rationale.selected-rationale {
            background-color: #d69e2e;
            border-left-color: #f6e05e;
        }
        body.dark-mode .button {
            background-color: #4299e1;
            box-shadow: 0 4px 10px rgba(66, 153, 225, 0.5);
        }
        body.dark-mode .button:hover {
            background-color: #3182ce;
        }
        body.dark-mode .button:disabled {
            background-color: #718096;
        }
        body.dark-mode .progress-bar {
            background-color: #4a5568;
        }
        body.dark-mode .unanswered-section {
            background-color: #63b3ed;
            color: #2d3748; /* Texte fonc√© pour le bleu clair en mode sombre */
        }
        body.dark-mode .score-display {
            color: #e2e8f0; /* Assure que le score-display est clair en mode sombre */
        }
        body.dark-mode .hint-text, body.dark-mode .pre-choice-hint {
            color: #a0aec0;
        }
        body.dark-mode .interactive-hint-display {
            background-color: #4a5568;
            border-color: #f6e05e;
            color: #e2e8f0;
        }
        body.dark-mode .footer-links {
            background-color: #2d3748;
            border-top-color: #4a5568;
            color: #e2e8f0; /* Rend le texte du pied de page explicitement clair */
        }
        body.dark-mode .footer-links a {
            color: #63b3ed;
        }
        body.dark-mode .footer-links a:hover {
            color: #4299e1;
        }
        body.dark-mode .footer-links .discord-button {
            background-color: #7289da;
            color: white; /* Assure que le texte est blanc pour le bouton discord en mode sombre */
        }
        body.dark-mode .footer-links .discord-button:hover {
            background-color: #677bc4;
        }
        body.dark-mode .footer-links .whatsapp-button {
            background-color: #25D366;
            color: white; /* Assure que le texte est blanc pour le bouton whatsapp en mode sombre */
        }
        body.dark-mode .whatsapp-button svg {
            fill: white; /* Assure que l'ic√¥ne SVG est blanche en mode sombre */
        }
        body.dark-mode .discord-button svg {
            fill: white; /* Assure que l'ic√¥ne SVG est blanche en mode sombre */
        }
        body.dark-mode .footer-links .whatsapp-button:hover {
            background-color: #1DA851;
        }
        body.dark-mode .theme-switcher {
            background-color: #4a5568;
            color: #e2e8f0;
            border: 1px solid #616e7f;
        }
        body.dark-mode .theme-switcher:hover {
            background-color: #616e7f;
        }


        /* Conteneur principal du quiz */
        .quiz-container {
            background-color: #ffffff; /* Fond blanc */
            border-radius: 15px; /* Coins arrondis */
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1); /* Ombre douce */
            padding: 30px;
            max-width: 800px; /* Largeur maximale pour la lisibilit√© */
            width: 100%; /* Pleine largeur sur petits √©crans */
            text-align: center;
            display: flex;
            flex-direction: column;
            gap: 20px; /* Espacement entre les √©l√©ments */
        }
        /* Style du texte de la question */
        .question-text {
            font-size: 1.5rem; /* Taille de police plus grande */
            font-weight: 600; /* Semi-gras */
            color: #333; /* Texte gris fonc√© */
            margin-bottom: 20px;
        }
        /* Style des options de r√©ponse individuelles */
        .answer-option {
            background-color: #e2e8f0; /* Gris-bleu clair */
            border-radius: 10px; /* Coins arrondis */
            padding: 15px 20px;
            margin-bottom: 10px;
            cursor: pointer; /* Indique que l'√©l√©ment est clickable */
            transition: background-color 0.3s ease, transform 0.2s ease; /* Transitions douces */
            text-align: left;
            font-size: 1.1rem;
            color: #4a5568; /* Texte gris moyen */
            border: 2px solid transparent; /* Bordure transparente pour la s√©lection */
        }
        /* Effet au survol des options de r√©ponse */
        .answer-option:hover {
            background-color: #93c5fd; /* Bleu plus doux (Tailwind blue-300) au survol */
            transform: translateY(-2px); /* L√©ger effet de soul√®vement */
        }
        /* Style de l'option de r√©ponse correcte */
        .answer-option.correct {
            background-color: #bfdbfe; /* Bleu-200 */
            border-color: #3b82f6; /* Bleu-500 */
        }
        /* Style de l'option de r√©ponse incorrecte */
        .answer-option.incorrect {
            background-color: #fce7f6; /* Pink-100 (plus clair) */
            border-color: #ec4899; /* Pink-500 (plus fuchsia) */
        }
        /* Style de l'option de r√©ponse s√©lectionn√©e par l'utilisateur */
        .answer-option.selected {
            background-color: #fffef0; /* Jaune-100 */
            border-color: #eab308; /* Jaune-500 */
        }
        /* Style du texte de la justification (rationale) */
        .rationale {
            font-size: 0.95rem;
            margin-top: 5px;
            padding: 10px;
            border-radius: 8px;
            text-align: left;
            color: #4a5568;
            background-color: #f0f2f5;
            border-left: 4px solid #60a5fa; /* Bordure gauche bleue-400 */
        }
        /* Style sp√©cifique de la justification pour les r√©ponses correctes */
        .rationale.correct-rationale {
            border-left-color: #3b82f6; /* Bleu-500 */
            background-color: #e0f2fe; /* Bleu-100 */
        }
        /* Style sp√©cifique de la justification pour les r√©ponses incorrectes */
        .rationale.incorrect-rationale {
            border-left-color: #ec4899; /* Pink-500 (plus fuchsia) */
            background-color: #fce7f6; /* Pink-100 (plus clair) */
        }
        /* Style sp√©cifique de la justification pour la r√©ponse s√©lectionn√©e par l'utilisateur */
        .rationale.selected-rationale {
            border-left-color: #eab308; /* Jaune-500 */
            background-color: #fffef0; /* Jaune-100 */
        }
        /* Style g√©n√©ral des boutons */
        .button {
            background-color: #1d4ed8; /* Fond bleu profond (Tailwind blue-700) */
            color: white; /* Texte blanc */
            padding: 12px 25px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 500;
            transition: background-color 0.3s ease, transform 0.2s ease; /* Transitions douces */
            border: none;
            box-shadow: 0 4px 10px rgba(66, 153, 225, 0.3); /* Ombre douce */
        }
        /* Effet au survol des boutons */
        .button:hover {
            background-color: #1e40af; /* Bleu plus fonc√© au survol (Tailwind blue-800) */
            transform: translateY(-2px); /* L√©ger effet de soul√®vement */
        }
        /* √âtat d√©sactiv√© des boutons */
        .button:disabled {
            background-color: #a0aec0; /* Gris√© lorsque d√©sactiv√© */
            cursor: not-allowed;
            box-shadow: none;
        }
        /* Conteneur de la barre de progression */
        .progress-bar {
            width: 100%;
            height: 20px; /* Plus √©pais */
            background-color: #e2e8f0;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 5px; /* Moins de marge pour rapprocher du score */
            display: flex; /* Utiliser flexbox pour les segments */
            font-weight: bold; /* Texte en gras dans la barre */
            color: white; /* Texte blanc par default pour les sections color√©es */
            font-size: 0.9em; /* Taille du texte dans la barre */
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5); /* Ombre pour la lisibilit√© */
        }
        /* Sections de la barre de progression et du graphique final */
        .progress-section {
            height: 100%;
            display: flex; /* Pour centrer le texte */
            align-items: center;
            justify-content: center;
            transition: width 0.3s ease-in-out; /* Transition de largeur douce */
            box-sizing: border-box; /* Pour inclure padding/border dans la largeur */
        }
        .correct-section { background-color: #1d4ed8; } /* Bleu profond (Tailwind blue-700) */
        .incorrect-section { background-color: #ec4899; } /* Fuchsia */
        .unanswered-section { background-color: #93c5fd; color: #4a5568; text-shadow: none; } /* Bleu doux (Tailwind blue-300), texte fonc√© */
        /* Style de l'affichage du score final */
        .score-display {
            font-size: 1.8rem;
            font-weight: 700;
            color: #2d3748; /* Texte gris fonc√© */
            margin-bottom: 20px;
        }
        /* Style du texte de l'indice */
        .hint-text {
            font-style: italic;
            color: #718096; /* Texte gris att√©nu√© */
            margin-top: 10px;
            font-size: 0.9rem;
        }
        .live-score-display {
            font-size: 1.1rem; /* Plus grand */
            font-weight: 600; /* Plus gras */
            color: #333;
            margin-top: 0px; /* Moins de marge pour rapprocher de la barre */
            margin-bottom: 10px;
            text-align: center; /* Centrer le texte */
        }

        /* Style sp√©cifique pour la barre de r√©sultats finaux */
        .final-results-chart-container {
            height: 30px; /* Plus √©pais pour le graphique final */
            margin-top: 20px;
            margin-bottom: 20px;
        }
        /* Pour le graphique final, on ne veut qu'une seule section pour le correct */
        .final-results-chart-container .incorrect-section,
        .final-results-chart-container .unanswered-section {
            display: none; /* Cacher ces sections dans le graphique final */
        }
        .final-results-chart-container .correct-section {
            width: 100% !important; /* Force la section correcte √† prendre toute la largeur disponible */
            justify-content: center; /* Centrer le texte */
        }
        /* Style pour le message de bonus */
        .bonus-message {
            margin-top: 15px;
            padding: 10px;
            border-radius: 8px;
            font-weight: bold;
            text-align: center;
        }
        .bonus-message.success {
            background-color: #d1fae5; /* Vert tr√®s clair */
            color: #065f46; /* Vert fonc√© */
            border: 1px solid #34d399;
        }
        .bonus-message.info {
            background-color: #e0f2fe; /* Bleu tr√®s clair */
            color: #2563eb; /* Bleu fonc√© */
            border: 1px solid #60a5fa;
        }

        /* Style pour l'indice interactif */
        .interactive-hint-display {
            margin-top: 15px;
            padding: 10px;
            border-radius: 8px;
            font-style: italic;
            color: #718096; /* Texte gris */
            background-color: #fef3c7; /* Fond jaune tr√®s clair */
            border: 1px solid #fcd34d; /* Bordure jaune */
            text-align: center;
            font-size: 1rem;
            transition: opacity 0.5s ease-in-out, transform 0.5s ease-in-out; /* Transition douce */
        }

        /* Animation de fondu */
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Style pour l'indice avant choix */
        .pre-choice-hint {
            margin-top: 10px;
            padding: 10px;
            border-radius: 8px;
            background-color: #f0f9ff; /* Bleu tr√®s tr√®s clair */
            color: #3b82f6; /* Bleu plus prononc√© */
            font-style: italic;
            text-align: center;
            font-size: 0.95rem;
            border: 1px solid #bfdbfe;
        }

        /* Styles pour les logos SVG */
        .footer-links svg {
            width: 1.5rem;
            height: 1.5rem;
            vertical-align: middle;
            display: inline-block; /* Pour aligner avec le texte */
        }
        .footer-links {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #cbd5e0; /* Bordure fine grise */
            font-size: 0.85rem; /* Texte plus petit */
            color: #4a5568;
        }
        .footer-links a {
            color: #1d4ed8; /* Bleu profond pour les liens */
            font-weight: 600;
            text-decoration: none;
            transition: color 0.2s ease;
        }
        .footer-links a:hover {
            color: #1e40af; /* Bleu plus fonc√© au survol */
            text-decoration: underline;
        }
        .footer-links .discord-button {
            background-color: #5865F2; /* Couleur Discord */
            color: white;
            padding: 8px 15px;
            border-radius: 8px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            transition: background-color 0.2s ease;
        }
        .footer-links .discord-button:hover {
            background-color: #4752C4;
        }
        .footer-links .whatsapp-button {
            background-color: #25D366; /* Couleur WhatsApp */
            color: white;
            padding: 8px 15px;
            border-radius: 8px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            transition: background-color 0.2s ease;
        }
        .footer-links .whatsapp-button:hover {
            background-color: #1DA851;
        }

        /* Styles pour le mode r√©vision */
        .review-question-card {
            background-color: #f8fafc;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            text-align: left;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
        }
        .review-question-card.dark-mode {
            background-color: #3b4553;
        }
        .review-question-card .question-text {
            font-size: 1.3rem;
            margin-bottom: 10px;
            color: #333;
        }
        .review-question-card.dark-mode .question-text {
            color: #e2e8f0;
        }
        .review-question-card .user-answer,
        .review-question-card .correct-answer {
            padding: 8px 12px;
            border-radius: 8px;
            margin-bottom: 8px;
            font-size: 1rem;
            font-weight: 500;
        }
        .review-question-card .user-answer {
            background-color: #fffef0; /* Jaune-100 */
            border: 1px solid #eab308; /* Jaune-500 */
        }
        .review-question-card.dark-mode .user-answer {
            background-color: #d69e2e;
            border-color: #f6e05e;
        }
        .review-question-card .correct-answer {
            background-color: #e0f2fe; /* Bleu-100 */
            border: 1px solid #3b82f6; /* Bleu-500 */
        }
        .review-question-card.dark-mode .correct-answer {
            background-color: #2c5282;
            border-color: #4299e1;
        }
        .review-question-card .rationale {
            margin-top: 10px;
            font-size: 0.9rem;
            background-color: #f0f2f5;
            border-left: 4px solid #60a5fa;
            color: #4a5568;
        }
        .review-question-card.dark-mode .rationale {
            background-color: #4a5568;
            border-left-color: #63b3ed;
            color: #e2e8f0;
        }
        .review-question-card .result-icon {
            font-size: 1.5em;
            vertical-align: middle;
            margin-right: 8px;
        }

        /* Styles pour le Glossaire */
        .glossary-term {
            text-align: left;
            margin-bottom: 15px;
            padding: 10px;
            border-radius: 8px;
            background-color: #f0f9ff; /* Bleu clair */
            border: 1px solid #bfdbfe;
            transition: background-color 0.3s ease;
        }
        .glossary-term.dark-mode {
            background-color: #3b4553;
            border-color: #4a5568;
        }
        .glossary-term h3 {
            font-weight: 600;
            font-size: 1.2rem;
            color: #2563eb; /* Bleu */
            margin-bottom: 5px;
        }
        .glossary-term.dark-mode h3 {
            color: #f48fb1; /* Rose plus clair pour le titre du glossaire en mode sombre */
        }
        .glossary-term p {
            font-size: 1rem;
            line-height: 1.5;
            color: #4a5568;
        }
        .glossary-term.dark-mode p {
            color: #e2e8f0;
        }

        /* Styles pour la s√©lection du mode de jeu */
        .game-mode-selection {
            margin-top: 20px;
            margin-bottom: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }
        .game-mode-selection label {
            font-weight: 500;
            color: #333;
        }
        body.dark-mode .game-mode-selection label {
            color: #e2e8f0;
        }
        .game-mode-selection select {
            padding: 8px 12px;
            border-radius: 8px;
            border: 1px solid #cbd5e0;
            background-color: #edf2f7;
            color: #2d3748;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        body.dark-mode .game-mode-selection select {
            background-color: #4a5568;
            border-color: #616e7f;
            color: #e2e8f0;
        }
        .game-mode-selection select:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 2px rgba(66, 153, 225, 0.5);
        }

        /* Affichage des vies */
        .lives-display {
            font-size: 1.2rem;
            font-weight: 600;
            color: #e53e3e; /* Rouge pour les vies */
            margin-bottom: 10px;
        }
        body.dark-mode .lives-display {
            color: #fc8181; /* Rouge plus clair en mode sombre */
        }

        /* Styles de l'√©cran du certificat */
        #certificateScreen {
            padding: 30px;
            background-color: #f8fafc;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            max-width: 600px;
            margin: 20px auto;
            text-align: center;
            position: relative;
            overflow: hidden;
            border: 5px solid #c2185b; /* Bordure rose fonc√© */
            box-shadow: 0 0 0 10px #f48fb1; /* Ombre rose plus claire */
        }
        #certificateScreen.dark-mode {
            background-color: #2d3748;
            color: #e2e8f0;
            border: 5px solid #f48fb1; /* Bordure rose claire en mode sombre */
            box-shadow: 0 0 0 10px #c2185b; /* Ombre rose fonc√© en mode sombre */
        }
        #certificateScreen h2 {
            font-size: 2.5rem;
            font-weight: 700;
            color: #1d4ed8;
            margin-bottom: 20px;
        }
        #certificateScreen.dark-mode h2 {
            color: #63b3ed;
        }
        #certificateScreen p {
            font-size: 1.2rem;
            margin-bottom: 10px;
            color: #4a5568;
        }
        #certificateScreen.dark-mode p {
            color: #e2e8f0;
        }
        #certificateScreen .signature {
            margin-top: 40px;
            font-style: italic;
            font-weight: 600;
            color: #2d3748;
        }
        #certificateScreen.dark-mode .signature {
            color: #a0aec0;
        }
        #certificateScreen input[type="text"] {
            padding: 8px 12px;
            border-radius: 8px;
            border: 1px solid #cbd5e0;
            width: 80%;
            max-width: 300px;
            margin-top: 10px;
            text-align: center;
            font-size: 1.1rem;
            color: #2d3748;
            background-color: #edf2f7;
        }
        #certificateScreen.dark-mode input[type="text"] {
            background-color: #4a5568;
            border-color: #616e7f;
            color: #e2e8f0;
        }
        #certificateScreen .club-logo-text {
            font-size: 1.5rem;
            font-weight: bold;
            color: #1d4ed8;
            margin-top: 20px;
        }
        #certificateScreen.dark-mode .club-logo-text {
            color: #63b3ed;
        }

        /* Couleur sp√©cifique pour le titre principal */
        h1.main-quiz-title {
            color: #c2185b; /* Rose fonc√© pour le mode clair */
        }
        body.dark-mode h1.main-quiz-title {
            color: #f48fb1; /* Rose plus clair pour le mode sombre */
        }

        /* Couleur sp√©cifique pour le titre du glossaire */
        #glossaryScreen h2 {
            color: #c2185b; /* Rose fonc√© pour le mode clair */
        }
        body.dark-mode #glossaryScreen h2 {
            color: #f48fb1; /* Rose plus clair pour le mode sombre */
        }
        /* Couleur sp√©cifique pour le texte de l'√©cran des r√©sultats */
        #resultsScreen .score-display,
        #resultsScreen p {
            color: #2d3748; /* Texte fonc√© par d√©faut pour le mode clair */
        }
        body.dark-mode #resultsScreen .score-display,
        body.dark-mode #resultsScreen p {
            color: #e2e8f0; /* Texte clair pour le mode sombre */
        }

        /* Couleur sp√©cifique pour le texte des statistiques dans l'√©cran des r√©sultats */
        .stats-text-color {
            color: #c2185b; /* Rose fonc√© pour le mode clair */
        }
        body.dark-mode .stats-text-color {
            color: #f48fb1; /* Rose plus clair pour le mode sombre */
        }

        /* Styles sp√©cifiques pour l'impression du certificat */
        @media print {
            body * {
                visibility: hidden; /* Cache tout par d√©faut */
            }
            #certificateScreen, #certificateScreen * {
                visibility: visible; /* Rend le certificat visible */
                color: black !important; /* Force le texte en noir pour l'impression */
                background-color: white !important; /* Force le fond blanc */
                box-shadow: none !important; /* Supprime les ombres */
                text-shadow: none !important; /* Supprime les ombres de texte */
            }
            #certificateScreen {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                height: 100%;
                margin: 0;
                padding: 50px; /* Ajoute du padding pour un encadrement visuel */
                border: 5mm solid #c2185b !important; /* Bordure plus √©paisse pour le dipl√¥me */
                box-sizing: border-box;
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
            }
            #certificateScreen h2,
            #certificateScreen p,
            #certificateScreen .signature,
            #certificateScreen .club-logo-text {
                color: black !important; /* Assure que tous les textes sont noirs */
            }
            #certificateScreen .club-logo-text {
                font-size: 1.8rem; /* Rendre le logo texte plus grand */
                color: #c2185b !important; /* Garder la couleur rose fonc√© pour le logo */
            }
            #certificateScreen .signature {
                color: #333 !important; /* Signature en gris fonc√© */
            }
            #certificateScreen #userNameInput {
                border: none; /* Supprime la bordure du champ de saisie */
                border-bottom: 2px solid black; /* Ajoute une ligne de signature */
                width: 70%;
                background-color: transparent !important;
                color: black !important;
                font-weight: bold;
                font-size: 1.5rem;
                padding: 5px 0;
                margin-bottom: 20px;
            }
            /* Masquer les boutons d'impression et de retour */
            #certificateScreen button {
                display: none !important;
            }
        }
    </style>
</head>
<body>
    <div class="quiz-container">
        <h1 class="text-3xl font-bold text-gray-800 mb-6 main-quiz-title">üß†üí° 02 Pr√©sentation de la Gestion de la Paie üìö‚ú®</h1>

        <!-- S√©lecteur de th√®me et de son -->
        <div class="flex justify-end gap-2 mb-4">
            <button id="themeSwitcher" class="theme-switcher bg-gray-200 text-gray-800 py-2 px-4 rounded-full shadow-md transition-colors duration-300">
                Basculer le th√®me
            </button>
            <button id="soundToggle" class="theme-switcher bg-gray-200 text-gray-800 py-2 px-4 rounded-full shadow-md transition-colors duration-300">
                üîä Muet
            </button>
        </div>

        <!-- √âcran de d√©marrage -->
        <div id="startScreen" class="text-center p-6">
            <p class="text-xl text-gray-700 mb-6">Bienvenue au Quiz interactif sur la Pr√©sentation de la Gestion de la Paie !</p>
            <p class="text-lg text-gray-600 mb-8">
                <span class="text-2xl">üéâ</span> Ce quiz est propos√© par <span class="font-bold text-blue-700">üî•Payroll Boss Elite Club üëë</span> ! <span class="text-2xl">üöÄ</span>
            </p>

            <div class="game-mode-selection">
                <label for="gameModeSelect">Choisissez un mode de jeu :</label>
                <select id="gameModeSelect">
                    <option value="normal">Mode Normal (avec minuteur)</option>
                    <option value="survival">Mode Survie (3 vies)</option>
                </select>
            </div>

            <div class="game-mode-selection">
                <label for="numQuestionsSelect">Nombre de questions :</label>
                <select id="numQuestionsSelect">
                    <option value="5">5 questions</option>
                    <option value="10">10 questions</option>
                    <option value="15">15 questions</option>
                    <option value="all">Toutes les questions</option>
                </select>
            </div>

            <button id="startButton" class="button">Commencer le Quiz</button>
            <button id="continueButton" class="button mt-4 hidden">Continuer le Quiz (progression sauvegard√©e)</button>
            <button id="glossaryButtonStart" class="button mt-4 ml-4 bg-gray-600 hover:bg-gray-700">Glossaire</button>
        </div>

        <!-- √âcran du quiz -->
        <div id="quizScreen" class="hidden">
            <div id="timerDisplay" class="text-xl font-bold text-gray-700 mb-4">Temps restant : --:--</div>
            <div id="livesDisplay" class="lives-display hidden">Vies restantes : </div>
            <div id="liveScoreDisplay" class="live-score-display"></div>
            <div class="progress-bar" id="progressBar">
                <div class="progress-section correct-section" id="correctProgress"></div>
                <div class="progress-section incorrect-section" id="incorrectProgress"></div>
                <div class="progress-section unanswered-section" id="unansweredProgress"></div>
            </div>
            <div id="quiz" class="flex flex-col gap-4">
                <!-- La question et les r√©ponses seront charg√©es ici par JavaScript -->
            </div>
            <div id="navigation" class="flex justify-between mt-6">
                <button id="prevButton" class="button" disabled>Pr√©c√©dent</button>
                <button id="nextButton" class="button">Suivant</button>
            </div>
        </div>

        <!-- √âcran des r√©sultats -->
        <div id="resultsScreen" class="hidden text-center">
            <!-- Les r√©sultats seront affich√©s ici par JavaScript -->
            <button id="reviewButton" class="button mt-6">Revoir les r√©ponses</button>
            <button id="restartButton" class="button mt-6 ml-4">Recommencer le Quiz</button>
            <button id="glossaryButtonResults" class="button mt-6 ml-4 bg-gray-600 hover:bg-gray-700">Glossaire</button>
            <button id="certificateButton" class="button mt-6 ml-4 bg-yellow-500 hover:bg-yellow-600 hidden">Voir mon Certificat</button>
        </div>

        <!-- √âcran du mode r√©vision -->
        <div id="reviewModeScreen" class="hidden text-center">
            <h2 class="text-2xl font-bold text-gray-800 mb-6">Revue des R√©ponses</h2>
            <div id="reviewQuestionsContainer" class="flex flex-col gap-4">
                <!-- Les questions r√©vis√©es seront ins√©r√©es ici -->
            </div>
            <button id="backToResultsButton" class="button mt-6">Retour aux R√©sultats</button>
        </div>

        <!-- √âcran du glossaire -->
        <div id="glossaryScreen" class="hidden text-center">
            <h2 class="text-2xl font-bold text-gray-800 mb-6">Glossaire de la Pr√©sentation de la Gestion de la Paie</h2>
            <div id="glossaryContent" class="text-left">
                <!-- Les termes du glossaire seront charg√©s ici -->
            </div>
            <button id="backToStartFromGlossary" class="button mt-6">Retour √† l'Accueil</button>
        </div>

        <!-- √âcran du certificat -->
        <div id="certificateScreen" class="hidden">
            <h2 class="text-3xl font-bold mb-4">Certificat de R√©ussite</h2>
            <p class="text-xl mb-2">Ce certificat est d√©cern√© √†</p>
            <input type="text" id="userNameInput" placeholder="Votre Nom" class="text-center" />
            <p class="text-xl mt-4">pour avoir compl√©t√© le Quiz sur la Pr√©sentation de la Gestion de la Paie avec un score de</p>
            <p class="text-4xl font-bold text-blue-700 my-4" id="certificateScore">XX points</p>
            <p class="text-xl">en date du <span id="certificateDate"></span></p>
            <p class="club-logo-text mt-8">üî•Payroll Boss Elite Club üëë</p>
            <p class="signature">‚ú®√ânervante √ânervante ü•≥</p>
            <button id="printCertificateButton" class="button mt-6 bg-green-500 hover:bg-green-600">Imprimer le Certificat</button>
            <button id="backToResultsFromCertificate" class="button mt-6 ml-4">Retour aux R√©sultats</button>
        </div>

        <!-- Liens de pied de page -->
        <div class="footer-links mt-8 p-4 bg-gray-100 rounded-lg shadow-inner text-center">
            <p class="text-lg font-semibold text-gray-700 mb-4">
                üöÄ Pr√™t(e) √† aller plus loin ? Rejoignez notre communaut√© pour √©changer et progresser ensemble !
            </p>
            <div class="flex flex-col sm:flex-row justify-center items-center gap-4">
                <a href="https://discord.gg/cBnBkGDFgk" target="_blank" class="discord-button">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                        <path d="M20.22 0H3.78C1.7 0 0 1.7 0 3.78v16.44C0 22.3 1.7 24 3.78 24h16.44c2.08 0 3.78-1.7 3.78-3.78V3.78C24 1.7 22.3 0 20.22 0zM17.22 17.22H6.78V6.78h10.44v10.44zm-1.04-7.29a.94.94 0 01-.94.94h-2.18v2.18a.94.94 0 01-1.88 0v-2.18H8.81a.94.94 0 010-1.88h2.18V8.81a.94.94 0 011.88 0v2.18h2.18a.94.94 0 01.94.94z"/>
                        <path d="M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0zm5.219 17.839c-.469.096-.948.145-1.428.145-1.921 0-3.842-.73-5.303-2.191-1.46-1.46-2.191-3.382-2.191-5.303 0-.48.049-.959.145-1.428.096-.469.23-.92.399-1.348.17-.428.375-.83.615-1.205.24-.375.508-.72.804-1.034.296-.314.62-.59.972-.828.352-.238.72-.435 1.104-.588.384-.153.78-.261 1.188-.324.408-.063.82-.093 1.23-.093.41 0 .82.03 1.23.093.408.063.816.171 1.188.324.384.153.752.35 1.104.588.352.238.676.514.972.828.296.314.564.659.804 1.034.24.375.445.777.615 1.205.17.428.303.879.399 1.348.096.469.145.948.145 1.428 0 1.921-.73 3.842-2.191 5.303-1.46 1.46-3.382 2.191-5.303 2.191zM12 19.5c-4.142 0-7.5-3.358-7.5-7.5S7.858 4.5 12 4.5s7.5 3.358 7.5 7.5-3.358 7.5-7.5 7.5zM12 5c-3.866 0-7 3.134-7 7s3.134 7 7 7 7-3.134 7-7-3.134-7-7-7z"/>
                    </svg>
                    Discord üî• Payroll Boss Elite Club : Le Hub Paie & Progr√®s üìà
                </a>
                <a href="https://chat.whatsapp.com/EtV0ux5ipAG5JDhopzo0ut" target="_blank" class="whatsapp-button">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                        <path d="M12.03 2.03c-5.52 0-10 4.48-10 10s4.48 10 10 10 10-4.48 10-10-4.48-10-10-10zm.01 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm3.82-10.15c-.22-.12-.49-.18-.77-.18-.28 0-.55.06-.77.18-.22.12-.39.29-.49.49-.1.2-.15.44-.15.71 0 .27.05.5.15.71.1.2.27.37.49.49.22.12.49.18.77.18.28 0 .55-.06.77-.18.22-.12.39-.29.49-.49.1-.2.15-.44.15-.71 0-.27-.05-.5-.15-.71-.1-.2-.27-.37-.49-.49zm-7.64 0c-.22-.12-.49-.18-.77-.18-.28 0-.55.06-.77.18-.22.12-.39.29-.49.49-.1.2-.15.44-.15.71 0 .27.05.5.15.71.1.2.27.37.49.49.22.12.49.18.77.18.28 0 .55-.06.77-.18.22-.12.39-.29.49-.49.1-.2.15-.44.15-.71 0-.27-.05-.5-.15-.71-.1-.2-.27-.37-.49-.49z"/>
                    </svg>
                    WhatsApp üî• | Payroll Boss Elite Club üëë| Infos & Actus
                </a>
            </div>
            <p class="text-xs mt-4 text-gray-500">
                ¬© <span id="currentYear"></span> <span id="copyrightText">Payroll Boss Elite Club. Tous droits r√©serv√©s.</span>
            </p>
        </div>
    </div>

    <script>
        // Donn√©es du quiz
        const quizData = {
            "questions": [
                {
                    "question": "Quel est le r√¥le principal du 'Service Paie' en entreprise, tel que d√©crit dans les organisations de gestion de la paie ?",
                    "hint": "Il s'agit d'une fonction ax√©e sur la conformit√© et la production de documents.",
                    "preChoiceHint": "Le Service Paie, c'est un peu le gardien du temple des chiffres et des r√®gles ! üèõÔ∏è",
                    "answerOptions": [
                        {
                            "text": "‚ú® G√©rer les recrutements et les d√©parts de salari√©s.",
                            "rationale": "‚ùå Cette t√¢che rel√®ve g√©n√©ralement du service du personnel ou de la Direction des Ressources Humaines, pas sp√©cifiquement du Service Paie.",
                            "isCorrect": false
                        },
                        {
                            "text": "‚ú® Se conformer √† la l√©gislation sociale et produire les documents sociaux obligatoires.",
                            "rationale": "‚úÖ Le Service Paie est essentiellement cantonn√© √† des t√¢ches dont l'objectif principal est de se conformer √† la l√©gislation sociale et de produire tous les documents sociaux obligatoires (contrats de travail, attestations, certificats, bulletins de salaire et d√©clarations sociales).",
                            "isCorrect": true
                        },
                        {
                            "text": "‚ú® D√©finir la politique de r√©mun√©ration de l'entreprise.",
                            "rationale": "‚ùå La d√©finition de la politique de r√©mun√©ration est une fonction strat√©gique qui rel√®ve g√©n√©ralement de la Direction des Ressources Humaines ou de la Direction G√©n√©rale.",
                            "isCorrect": false
                        },
                        {
                            "text": "‚ú® Assurer la gestion des relations entre membres du personnel.",
                            "rationale": "‚ùå Cette dimension de gestion des relations est prise en charge par le Service du Personnel, qui a un champ d'action plus √©tendu que le simple Service Paie.",
                            "isCorrect": false
                        }
                    ]
                },
                {
                    "question": "Quelle est la principale caract√©ristique des t√¢ches du 'Service Paie' en entreprise ?",
                    "hint": "Pensez √† leur nature et leur fr√©quence.",
                    "preChoiceHint": "La paie, c'est comme une horloge suisse : √ßa doit √™tre pr√©cis et r√©gulier ! ‚è∞",
                    "answerOptions": [
                        {
                            "text": "‚ú® Elles sont principalement ponctuelles et impr√©visibles.",
                            "rationale": "‚ùå Les t√¢ches du Service Paie sont d√©crites comme √©tant quantifiables, r√©guli√®res et ais√©ment planifiables, et non ponctuelles ou impr√©visibles.",
                            "isCorrect": false
                        },
                        {
                            "text": "‚ú® Elles sont quantifiables, r√©guli√®res et ais√©ment planifiables.",
                            "rationale": "‚úÖ Les t√¢ches du Service Paie sont caract√©ris√©es par leur nature quantifiable, r√©guli√®re et ais√©ment planifiable, ce qui permet une organisation efficace de cette fonction.",
                            "isCorrect": true
                        },
                        {
                            "text": "‚ú® Elles n√©cessitent une grande adaptabilit√© aux changements quotidiens.",
                            "rationale": "‚ùå Bien que l'adaptabilit√© soit une qualit√© requise pour le gestionnaire de paie en g√©n√©ral, la nature des t√¢ches du Service Paie en entreprise est plus ax√©e sur la r√©gularit√© et la planification.",
                            "isCorrect": false
                        },
                        {
                            "text": "‚ú® Elles sont majoritairement ax√©es sur la mission de conseil.",
                            "rationale": "‚ùå La mission de conseil est plus caract√©ristique d'un p√¥le social en cabinet d'expertise comptable, pas du r√¥le principal d'un Service Paie en entreprise.",
                            "isCorrect": false
                        }
                    ]
                },
                {
                    "question": "Comment le 'Service du Personnel' se distingue-t-il du 'Service Paie' en entreprise ?",
                    "hint": "Pensez √† l'√©tendue de son champ d'action.",
                    "preChoiceHint": "Le Service du Personnel a une vision plus large que le Service Paie. C'est le grand fr√®re ! üßë‚Äçü§ù‚Äçüßë",
                    "answerOptions": [
                        {
                            "text": "‚ú® Il est uniquement charg√© de la production des bulletins de paie.",
                            "rationale": "‚ùå C'est la fonction principale du Service Paie, tandis que le Service du Personnel a un champ d'action plus √©tendu.",
                            "isCorrect": false
                        },
                        {
                            "text": "‚ú® Il ajoute une dimension de gestion des relations entre membres du personnel et entre salari√©(s) et employeur.",
                            "rationale": "‚úÖ Le Service du Personnel a un champ d'action plus √©tendu que le Service Paie, en y ajoutant la gestion des relations entre les membres du personnel et entre les salari√©s et l'employeur, ainsi que l'apport d'outils d'aide √† la d√©cision pour l'employeur.",
                            "isCorrect": true
                        },
                        {
                            "text": "‚ú® Il est toujours int√©gr√© √† une direction comptable.",
                            "rationale": "‚ùå Le Service du Personnel est souvent int√©gr√© √† une direction financi√®re et s'affranchit de l'autorit√© du service comptable, contrairement au Service Paie qui peut y √™tre int√©gr√©.",
                            "isCorrect": false
                        },
                        {
                            "text": "‚ú® Il est exclusivement d√©di√© √† la gestion des carri√®res et de la formation.",
                            "rationale": "‚ùå Ces t√¢ches peuvent faire partie de ses attributions, mais le r√¥le principal du Service du Personnel est plus large, incluant la gestion des relations et les obligations sociales.",
                            "isCorrect": false
                        }
                    ]
                },
                {
                    "question": "Quelle est l'une des principales raisons pour laquelle une entreprise choisit d'externaliser la gestion de sa paie ?",
                    "hint": "Pensez √† la complexit√© et √† l'√©volution constante des r√®gles.",
                    "preChoiceHint": "Pourquoi faire soi-m√™me quand un expert peut le faire mieux et vous lib√©rer l'esprit ! ü§î",
                    "answerOptions": [
                        {
                            "text": "‚ú® Pour r√©duire le salaire de base des employ√©s.",
                            "rationale": "‚ùå L'externalisation est une strat√©gie de gestion administrative, pas un moyen de r√©duire directement les salaires des employ√©s.",
                            "isCorrect": false
                        },
                        {
                            "text": "‚ú® Pour s'affranchir des contraintes et responsabilit√©s li√©es √† l'√©volution constante des r√®gles de paie.",
                            "rationale": "‚úÖ Les r√®gles de traitement administratif de la paie sont en constante √©volution (modifications p√©riodiques des bases et taux de cotisations, r√©glementations, conventions, r√©formes, aides). L'externalisation permet √† l'entreprise de transf√©rer cette gestion √† un prestataire externe et ainsi de s'affranchir de ces contraintes et responsabilit√©s.",
                            "isCorrect": true
                        },
                        {
                            "text": "‚ú® Pour augmenter le contr√¥le interne sur les donn√©es de paie.",
                            "rationale": "‚ùå L'externalisation transf√®re la gestion √† un tiers, ce qui peut r√©duire le contr√¥le interne direct, bien que le prestataire doive assurer la conformit√©.",
                            "isCorrect": false
                        },
                        {
                            "text": "‚ú® Pour former son personnel interne √† la gestion de paie.",
                            "rationale": "‚ùå L'externalisation vise √† confier la t√¢che √† un sp√©cialiste externe, non √† former le personnel interne √† cette fonction.",
                            "isCorrect": false
                        }
                    ]
                },
                {
                    "question": "Combien de paies par mois, en moyenne, un cabinet comptable avec un p√¥le social peut-il traiter ?",
                    "hint": "Il y a une fourchette de volume de paies trait√©es par ces cabinets.",
                    "preChoiceHint": "Les cabinets comptables, ce sont de vraies usines √† paie ! üè≠",
                    "answerOptions": [
                        {
                            "text": "‚ú® Moins de 50 paies.",
                            "rationale": "‚ùå Un p√¥le social en cabinet comptable traite un volume de paies bien plus important que 50 par mois.",
                            "isCorrect": false
                        },
                        {
                            "text": "‚ú® Entre 200 et 7 500 paies.",
                            "rationale": "‚úÖ Les cabinets comptables ayant un p√¥le social traitent g√©n√©ralement entre 200 et 7 500 paies par mois, ce qui t√©moigne de leur sp√©cialisation et de leur capacit√© √† g√©rer des volumes importants.",
                            "isCorrect": true
                        },
                        {
                            "text": "‚ú® Plus de 10 000 paies.",
                            "rationale": "‚ùå La fourchette moyenne indiqu√©e est inf√©rieure √† 10 000 paies par mois pour un p√¥le social en cabinet comptable.",
                            "isCorrect": false
                        },
                        {
                            "text": "‚ú® Environ 50 paies par gestionnaire de paie.",
                            "rationale": "‚ùå 50 paies est le nombre moyen de dossiers par gestionnaire de paie, pas le volume total du cabinet. Le volume total est bien plus √©lev√©.",
                            "isCorrect": false
                        }
                    ]
                },
                {
                    "question": "Quelle est l'une des t√¢ches sp√©cifiques au suivi des salari√©s lors de l'embauche ?",
                    "hint": "Pensez aux formalit√©s administratives initiales.",
                    "preChoiceHint": "La premi√®re impression compte, surtout pour les papiers ! üìù",
                    "answerOptions": [
                        {
                            "text": "‚ú® La gestion des cong√©s pay√©s.",
                            "rationale": "‚ùå La gestion des cong√©s pay√©s est une t√¢che de suivi pendant le travail dans l'entreprise, pas sp√©cifiquement √† l'embauche.",
                            "isCorrect": false
                        },
                        {
                            "text": "‚ú® L'√©laboration et la remise du contrat de travail.",
                            "rationale": "‚úÖ L'√©laboration et la remise du contrat de travail sont des t√¢ches essentielles lors de l'embauche des salari√©s, faisant partie des d√©marches administratives initiales.",
                            "isCorrect": true
                        },
                        {
                            "text": "‚ú® Le calcul des provisions de fin d'ann√©e.",
                            "rationale": "‚ùå Le calcul des provisions de fin d'ann√©e est une t√¢che li√©e √† l'√©laboration des bulletins de paie et des d√©clarations sociales, et non au suivi des salari√©s √† l'embauche.",
                            "isCorrect": false
                        },
                        {
                            "text": "‚ú® La gestion des litiges avec les organismes de retraite.",
                            "rationale": "‚ùå La gestion des litiges est une t√¢che qui peut survenir √† diff√©rents moments, mais n'est pas sp√©cifique au processus d'embauche.",
                            "isCorrect": false
                        }
                    ]
                },
                {
                    "question": "Parmi les qualit√©s suivantes, laquelle est sp√©cifiquement mise en avant pour un gestionnaire de paie en raison du traitement de donn√©es confidentielles ?",
                    "hint": "Pensez √† la protection des informations personnelles.",
                    "preChoiceHint": "Le gestionnaire de paie est un peu comme un coffre-fort humain... mais avec le sourire ! üòâ",
                    "answerOptions": [
                        {
                            "text": "‚ú® L'organisation.",
                            "rationale": "‚ùå L'organisation est une qualit√© importante pour g√©rer les √©ch√©ances, mais pas sp√©cifiquement li√©e √† la confidentialit√© des donn√©es.",
                            "isCorrect": false
                        },
                        {
                            "text": "‚ú® La rigueur.",
                            "rationale": "‚ùå La rigueur est essentielle pour √©viter les erreurs de calcul, mais pas directement pour la confidentialit√©.",
                            "isCorrect": false
                        },
                        {
                            "text": "‚ú® La discr√©tion.",
                            "rationale": "‚úÖ La discr√©tion est une qualit√© essentielle requise chez un gestionnaire de paie, notamment en raison du traitement de donn√©es confidentielles des salari√©s.",
                            "isCorrect": true
                        },
                        {
                            "text": "‚ú® La curiosit√©.",
                            "rationale": "‚ùå La curiosit√© est utile pour suivre l'actualit√© sociale et les conventions, mais pas pour la confidentialit√© des donn√©es.",
                            "isCorrect": false
                        }
                    ]
                },
                {
                    "question": "Vrai ou Faux : Un gestionnaire de paie en entreprise n'est jamais amen√© √† r√©diger un contrat de travail.",
                    "hint": "Le r√¥le du gestionnaire de paie peut √™tre √©tendu dans certaines organisations.",
                    "preChoiceHint": "Le gestionnaire de paie, un r√¥le parfois surprenant ! üò≤",
                    "answerOptions": [
                        {
                            "text": "‚ú® Vrai.",
                            "rationale": "‚ùå C'est incorrect. Le document indique que le gestionnaire de paie en entreprise peut √™tre amen√© √† √©tablir une fiche de poste ou r√©diger un contrat de travail, selon l'organisation de l'entreprise.",
                            "isCorrect": false
                        },
                        {
                            "text": "‚ú® Faux.",
                            "rationale": "‚úÖ Le gestionnaire de paie en entreprise peut √™tre amen√© √† √©tablir une fiche de poste ou r√©diger un contrat de travail, ainsi qu'√† participer aux activit√©s d'administration du personnel. Son r√¥le n'est pas limit√© √† la seule production des bulletins.",
                            "isCorrect": true
                        }
                    ],
                    "interactiveHint": { "text": "Le gestionnaire de paie n'est pas qu'un simple calculateur, c'est aussi un architecte de carri√®res ! üë∑" }
                },
                {
                    "question": "Quel est le statut social d'un g√©rant minoritaire ou √©galitaire de SARL ?",
                    "hint": "Pensez √† sa protection sociale par rapport aux salari√©s.",
                    "preChoiceHint": "Certains dirigeants ont un statut un peu hybride... Ni tout √† fait salari√©, ni tout √† fait ind√©pendant. ü§î",
                    "answerOptions": [
                        {
                            "text": "‚ú® Non-salari√©.",
                            "rationale": "‚ùå Le g√©rant minoritaire ou √©galitaire de SARL ne rel√®ve pas du r√©gime des non-salari√©s. Ce statut est r√©serv√© aux g√©rants majoritaires ou aux entreprises individuelles.",
                            "isCorrect": false
                        },
                        {
                            "text": "‚ú® Assimil√©-salari√©.",
                            "rationale": "‚úÖ Les g√©rants minoritaires ou √©galitaires de SARL sont consid√©r√©s comme des 'assimil√©s-salari√©s'. Ils b√©n√©ficient de la m√™me protection sociale que les salari√©s, √† l'exception de l'assurance ch√¥mage.",
                            "isCorrect": true
                        },
                        {
                            "text": "‚ú® Ind√©pendant.",
                            "rationale": "‚ùå Le statut d'ind√©pendant est distinct de celui d'assimil√©-salari√© et ne s'applique pas au g√©rant minoritaire ou √©galitaire de SARL.",
                            "isCorrect": false
                        },
                        {
                            "text": "‚ú® Salari√© avec contrat de travail.",
                            "rationale": "‚ùå Bien qu'il ait une protection sociale similaire, le g√©rant minoritaire ou √©galitaire n'a pas n√©cessairement un contrat de travail pour son mandat social, sauf cumul de fonctions sous conditions.",
                            "isCorrect": false
                        }
                    ]
                },
                {
                    "question": "Vrai ou Faux : Les dirigeants assimil√©s-salari√©s cotisent √† l'assurance ch√¥mage et peuvent b√©n√©ficier de ses prestations.",
                    "hint": "Il y a une exception importante √† leur protection sociale.",
                    "preChoiceHint": "M√™me les 'presque' salari√©s ont leurs petites sp√©cificit√©s ! üòâ",
                    "answerOptions": [
                        {
                            "text": "‚ú® Vrai.",
                            "rationale": "‚ùå C'est incorrect. Les dirigeants assimil√©s-salari√©s ne cotisent pas √† l'assurance ch√¥mage et ne peuvent donc pas b√©n√©ficier de ses prestations au titre de leur mandat social, sauf s'ils cumulent leur mandat avec un v√©ritable contrat de travail sous certaines conditions.",
                            "isCorrect": false
                        },
                        {
                            "text": "‚ú® Faux.",
                            "rationale": "‚úÖ Les dirigeants assimil√©s-salari√©s ne cotisent ni au dialogue social, ni √† l'assurance ch√¥mage, ni √† l'AGS et ne b√©n√©ficient pas de r√©duction de cotisation. C'est une sp√©cificit√© de leur statut par rapport aux salari√©s classiques.",
                            "isCorrect": true
                        }
                    ],
                    "interactiveHint": { "text": "Attention au pi√®ge du ch√¥mage pour les assimil√©s-salari√©s ! üò¨" }
                },
                {
                    "question": "Quelle est la principale caract√©ristique qui distingue un salari√© d'un ind√©pendant, selon la l√©gislation fran√ßaise ?",
                    "hint": "Il s'agit d'un lien juridique fondamental.",
                    "preChoiceHint": "C'est la diff√©rence fondamentale qui change tout ! ‚öñÔ∏è",
                    "answerOptions": [
                        {
                            "text": "‚ú® Le montant de la r√©mun√©ration.",
                            "rationale": "‚ùå Le montant de la r√©mun√©ration peut varier pour les deux statuts et n'est pas le crit√®re principal de distinction l√©gale.",
                            "isCorrect": false
                        },
                        {
                            "text": "‚ú® Le fait de travailler pour une entreprise.",
                            "rationale": "‚ùå Un ind√©pendant peut travailler pour une entreprise (son client) sans √™tre salari√©. Ce n'est pas le crit√®re distinctif.",
                            "isCorrect": false
                        },
                        {
                            "text": "‚ú® L'existence d'un lien de subordination.",
                            "rationale": "‚úÖ Le lien de subordination est la caract√©ristique essentielle qui distingue le statut de salari√© du statut d'ind√©pendant. Il implique que le salari√© ex√©cute un travail sous l'autorit√© d'un employeur qui a le pouvoir de donner des ordres, d'en contr√¥ler l'ex√©cution et de sanctionner les manquements.",
                            "isCorrect": true
                        },
                        {
                            "text": "‚ú® Le type de dipl√¥me obtenu.",
                            "rationale": "‚ùå Le dipl√¥me n'est pas un crit√®re l√©gal de distinction entre salari√© et ind√©pendant. Il peut influencer la qualification ou le poste, mais pas le statut juridique de base.",
                            "isCorrect": false
                        }
                    ]
                },
                {
                    "question": "Vrai ou Faux : Une entreprise peut √™tre consid√©r√©e comme utilisant de la main d'≈ìuvre dissimul√©e si elle ne v√©rifie pas l'immatriculation l√©gale de son prestataire ind√©pendant.",
                    "hint": "Pensez aux risques de non-conformit√© pour l'entreprise.",
                    "preChoiceHint": "Mieux vaut pr√©venir que gu√©rir... surtout avec l'URSSAF ! üö®",
                    "answerOptions": [
                        {
                            "text": "‚ú® Vrai.",
                            "rationale": "‚úÖ Une entreprise peut √™tre consid√©r√©e comme utilisant de la main d'≈ìuvre dissimul√©e dans le cas o√π elle connaissait ou ne pouvait pas ignorer le d√©faut d'immatriculation l√©gale de son prestataire. L'URSSAF peut alors exiger le paiement de cotisations salariales et patronales ainsi que des p√©nalit√©s.",
                            "isCorrect": true
                        },
                        {
                            "text": "‚ú® Faux.",
                            "rationale": "‚ùå C'est incorrect. Le document met en garde contre ce risque et sugg√®re d'√™tre prudent en cas de doute sur le statut d'un prestataire, m√™me si la v√©rification n'est pas un r√¥le direct de l'entreprise.",
                            "isCorrect": false
                        }
                    ],
                    "interactiveHint": { "text": "Un prestataire ind√©pendant, c'est comme un iceberg : la partie cach√©e peut √™tre risqu√©e ! üßä" }
                },
                {
                    "question": "Quels sont les deux crit√®res d√©terminants sur lesquels la jurisprudence s'appuie pour d√©terminer si un salari√© est consid√©r√© comme un cadre ?",
                    "hint": "Ces crit√®res vont au-del√† du simple titre de poste.",
                    "preChoiceHint": "Le titre ne fait pas toujours le moine... ni le cadre ! üéì",
                    "answerOptions": [
                        {
                            "text": "‚ú® L'√¢ge et l'anciennet√© dans l'entreprise.",
                            "rationale": "‚ùå L'√¢ge et l'anciennet√© ne sont pas les crit√®res d√©terminants pour la qualification de cadre selon la jurisprudence. Ces √©l√©ments peuvent influencer d'autres droits, mais pas le statut de cadre en soi.",
                            "isCorrect": false
                        },
                        {
                            "text": "‚ú® Le crit√®re des connaissances professionnelles et le crit√®re des fonctions r√©ellement exerc√©es.",
                            "rationale": "‚úÖ La jurisprudence s'appuie sur deux crit√®res d√©terminants : le crit√®re des connaissances professionnelles (dipl√¥me ou exp√©rience particuli√®re) et le crit√®re des fonctions r√©ellement exerc√©es (degr√© d'initiative, d'autonomie, de responsabilit√© et pouvoir de commandement).",
                            "isCorrect": true
                        },
                        {
                            "text": "‚ú® Le nombre d'heures travaill√©es par semaine et le type de contrat de travail.",
                            "rationale": "‚ùå Le nombre d'heures et le type de contrat d√©finissent le temps de travail et le cadre juridique de l'emploi, mais pas le statut de cadre.",
                            "isCorrect": false
                        },
                        {
                            "text": "‚ú® La participation aux r√©unions du Comit√© Social et √âconomique (CSE) et le niveau de salaire de base.",
                            "rationale": "‚ùå La participation au CSE n'est pas un crit√®re de statut cadre. Le niveau de salaire peut √™tre pris en consid√©ration, mais il n'est pas un crit√®re d√©terminant √† lui seul.",
                            "isCorrect": false
                        }
                    ]
                },
                {
                    "question": "Vrai ou Faux : Tous les cadres b√©n√©ficient automatiquement d'une convention de forfait annuel en jours.",
                    "hint": "Le Code du travail pr√©voit des options pour l'organisation du temps de travail des cadres.",
                    "preChoiceHint": "Forfait jour ou 35h, m√™me les cadres ont le choix (ou presque) ! ‚öñÔ∏è",
                    "answerOptions": [
                        {
                            "text": "‚ú® Vrai.",
                            "rationale": "‚ùå C'est incorrect. Le document pr√©cise que 'Tous les cadres ne sont pas automatiquement au forfait heures ou au forfait jours. La dur√©e de travail des cadres peut √©galement √™tre mensualis√©e. Ils peuvent donc √™tre amen√©s √† travailler 35 h par semaine.'",
                            "isCorrect": false
                        },
                        {
                            "text": "‚ú® Faux.",
                            "rationale": "‚úÖ Le Code du travail pr√©voit la possibilit√© d'organi la r√©mun√©ration des cadres sous convention de forfait annuel en heures ou en jours, mais ce n'est pas automatique. Leur dur√©e de travail peut √©galement √™tre mensualis√©e (35 heures par semaine).",
                            "isCorrect": true
                        }
                    ],
                    "interactiveHint": { "text": "Un cadre au forfait, c'est comme un super-h√©ros : il g√®re son temps, mais pas n'importe comment ! ü¶∏‚Äç‚ôÄÔ∏è" }
                },
                {
                    "question": "Quelle est l'obligation sp√©cifique impos√©e aux entreprises employant des cadres ou assimil√©s cadres concernant la pr√©voyance, selon la Convention Collective Nationale de retraite et de pr√©voyance des cadres du 14 mars 1947 ?",
                    "hint": "Il s'agit d'une cotisation obligatoire avec une part employeur sp√©cifique.",
                    "preChoiceHint": "Un article de loi peut cacher une obligation importante... et co√ªteuse ! üí∞",
                    "answerOptions": [
                        {
                            "text": "‚ú® De souscrire une mutuelle obligatoire pour tous les cadres.",
                            "rationale": "‚ùå La mutuelle est obligatoire pour tous les salari√©s depuis 2016 (ANI), mais l'obligation sp√©cifique de l'article 7 de la CCN des cadres concerne une garantie d√©c√®s et une cotisation patronale minimale.",
                            "isCorrect": false
                        },
                        {
                            "text": "‚ú® De verser une cotisation obligatoire de 1,50% de la tranche 1 du salaire, int√©gralement prise en charge par l'employeur, pour une garantie d√©c√®s.",
                            "rationale": "‚úÖ L'article 7 de la Convention Collective Nationale de retraite et de pr√©voyance des cadres du 14 mars 1947 impose aux entreprises de verser une cotisation obligatoire, fix√©e √† 1,50% de la tranche 1 du salaire (dans la limite du plafond de la S√©curit√© sociale), et qui doit √™tre int√©gralement prise en charge par l'employeur, pour une garantie d√©c√®s.",
                            "isCorrect": true
                        },
                        {
                            "text": "‚ú® De proposer un r√©gime de pr√©voyance facultatif √† tous les cadres.",
                            "rationale": "‚ùå Il s'agit d'une cotisation obligatoire, non facultative, impos√©e par cette convention collective sp√©cifique.",
                            "isCorrect": false
                        },
                        {
                            "text": "‚ú® De financer la totalit√© des cotisations de retraite compl√©mentaire des cadres.",
                            "rationale": "‚ùå La cotisation de 1,50% concerne sp√©cifiquement une garantie d√©c√®s et non la totalit√© des cotisations de retraite compl√©mentaire, qui sont partag√©es entre employeur et salari√©.",
                            "isCorrect": false
                        }
                    ]
                }
            ]
        };

        // Donn√©es du glossaire (extraites du PDF fourni)
        const glossaryData = [
            {
                term: "Abattement SMIC mineur",
                definition: "Pour un salari√© mineur de moins de 18 ans et sans 6 mois de pratique professionnelle, un abattement sur le SMIC peut √™tre appliqu√© : 20% en de√ß√† de 17 ans, et 10% entre 17 et 18 ans."
            },
            {
                term: "AGS (Association de Garantie des Salari√©s)",
                definition: "Organisme qui garantit le paiement des salaires et autres cr√©ances des salari√©s en cas d'insolvabilit√© de l'employeur (redressement ou liquidation judiciaire)."
            },
            {
                term: "Assimil√©s-salari√©s",
                definition: "Cat√©gorie de dirigeants qui b√©n√©ficient de la m√™me protection sociale que les salari√©s, √† l'exception de l'assurance ch√¥mage."
            },
            {
                term: "Avantage en nature logement",
                definition: "Un logement mis √† disposition par l'employeur. Pour les dirigeants sociaux, l'√©valuation de cet avantage se fait √† sa valeur r√©elle, l'√©valuation forfaitaire √©tant exclue."
            },
            {
                term: "Bar√®me forfaitaire repas",
                definition: "Montant fix√© par l'administration pour √©valuer l'avantage en nature repas. Pour l'ann√©e 2025, il est fix√© √† 5,45 ‚Ç¨ par repas."
            },
            {
                term: "Clause de variation de r√©mun√©ration",
                definition: "Une clause du contrat de travail peut pr√©voir une variation de la r√©mun√©ration si elle est fond√©e sur des √©l√©ments objectifs ind√©pendants de la volont√© de l'employeur, ne fait pas porter le risque d'entreprise sur le salari√© et ne r√©duit pas la r√©mun√©ration sous les minima l√©gaux ou conventionnels."
            },
            {
                term: "Coffre-fort num√©rique",
                definition: "Espace s√©curis√© en ligne d√©di√© au stockage de documents √©lectroniques sensibles."
            },
            {
                term: "Conservation bulletin de paie √©lectronique",
                definition: "L'employeur doit garantir la conservation et la disponibilit√© du bulletin de paie √©lectronique pendant une dur√©e de cinquante ans, soit jusqu'√† ce que le salari√© ait atteint l'√¢ge de soixante-quinze ans."
            },
            {
                term: "Cotisations sociales",
                definition: "Divis√©es en deux grandes cat√©gories : les cotisations salariales (pay√©es par les salari√©s) et les cotisations patronales (pay√©es par les employeurs)."
            },
            {
                term: "Cotisations sociales salariales",
                definition: "Montant pay√© par le salari√© pour les assurances sociales, pr√©lev√© sur le salaire brut."
            },
            {
                term: "D√©claration Sociale Nominative (DSN)",
                definition: "Outil indispensable pour les d√©clarations sociales et le t√©l√©paiement des cotisations."
            },
            {
                term: "D√©mat√©rialisation bulletin de salaire",
                definition: "Depuis le 1er janvier 2017, l'accord pr√©alable du salari√© n'est plus n√©cessaire pour la d√©mat√©rialisation du bulletin de salaire. Le salari√© doit cependant √™tre inform√© de son droit de s'y opposer."
            },
            {
                term: "Direction des Ressources Humaines",
                definition: "Service charg√© de la gestion des carri√®res, des formations et de l'hygi√®ne et s√©curit√© au sein de l'entreprise."
            },
            {
                term: "√âl√©ments exclus du calcul SMIC",
                definition: "Certains √©l√©ments de r√©mun√©ration ne sont pas pris en compte pour la comparaison avec le SMIC, car ils ne sont pas la contrepartie directe du travail habituel. Exemples : primes d'anciennet√©, remboursements de frais."
            },
            {
                term: "Externalisation de la gestion de la paie",
                definition: "Consiste √† transf√©rer cette gestion √† un prestataire externe, et ainsi √† s'affranchir de ses contraintes et responsabilit√©s."
            },
            {
                term: "Interdiction indexation salaires",
                definition: "L'interdiction l√©gale d'indexer les salaires sur des indices g√©n√©raux (comme le SMIC ou le niveau g√©n√©ral des prix) vise √† √©viter une inflation incontr√¥lable due √† des augmentations automatiques (boucle prix-salaires)."
            },
            {
                term: "Lien de subordination",
                definition: "Caract√©ristique essentielle qui distingue le statut de salari√© du statut d'ind√©pendant."
            },
            {
                term: "Licenciement faute lourde et cong√©s pay√©s",
                definition: "Depuis le 4 mars 2016, suite √† une d√©cision du Conseil constitutionnel, le licenciement pour faute lourde ne prive plus le salari√© de son indemnit√© compensatrice de cong√©s pay√©s."
            },
            {
                term: "Mentions interdites bulletin de paie",
                definition: "Aucune mention relative √† l'activit√© de repr√©sentation des salari√©s (mandats syndicaux, etc.) ne doit figurer sur le bulletin de paie. Ces informations doivent √™tre sur une fiche annexe."
            },
            {
                term: "Paiement du salaire (modalit√©s)",
                definition: "Le paiement du salaire peut se faire en esp√®ces pour les montants inf√©rieurs √† 1 500 ‚Ç¨. Au-del√† de ce seuil, le paiement doit se faire par ch√®que ou virement bancaire ou postal."
            },
            {
                term: "Personne √† charge (saisie sur salaire)",
                definition: "La pr√©sence de personnes √† charge augmente les seuils d'insaisissabilit√© du salaire. Pour 2025, les seuils sont augment√©s de 1 720 ‚Ç¨ pour chaque personne √† charge du d√©biteur saisi."
            },
            {
                term: "P√¥le social (cabinet comptable)",
                definition: "Les cabinets comptables ayant un p√¥le social traitent entre 200 et 7 500 paies par mois."
            },
            {
                term: "Primes annuelles et SMIC",
                definition: "Les primes pay√©es en cours d'ann√©e en contrepartie ou √† l'occasion du travail sont prises en compte pour la d√©termination du salaire minimum pour le mois o√π elles ont √©t√© effectivement vers√©es. Elles ne sont pas r√©parties sur l'ensemble de l'ann√©e, sauf si une convention collective le pr√©voit par acomptes mensuels."
            },
            {
                term: "Prescription paiement salaire",
                definition: "Depuis le 17 juin 2013, les actions en paiement de salaire exerc√©es par les salari√©s se prescrivent par trois ans."
            },
            {
                term: "Preuve du paiement du salaire",
                definition: "La d√©livrance du bulletin de paie par l'employeur ne constitue pas une preuve du paiement effectif du salaire. C'est √† l'employeur de prouver le paiement par d'autres moyens (re√ßu, virement, etc.)."
            },
            {
                term: "Prime annuelle sur objectif (d√©part salari√©)",
                definition: "Lorsqu'une prime constitue la partie variable de la r√©mun√©ration vers√©e en contrepartie de l'activit√© du salari√©, elle s'acquiert au prorata de son temps de pr√©sence dans l'entreprise, m√™me si le salari√© quitte l'entreprise avant la date de versement habituelle."
            },
            {
                term: "R√©mun√©ration juridique",
                definition: "Sur le plan juridique, la r√©mun√©ration est la contrepartie du travail fourni par le salari√©. C'est la principale obligation de l'employeur dans le contrat de travail synallagmatique."
            },
            {
                term: "Retard paiement salaire et rupture contrat",
                definition: "Un retard de paiement du salaire de plus de deux mois peut justifier la prise d'acte de la rupture du contrat de travail aux torts de l'employeur, produisant les effets d'un licenciement sans cause r√©elle et s√©rieuse."
            },
            {
                term: "Salaire au temps",
                definition: "Le salaire au temps est uniquement fonction du nombre d'heures de travail accomplies par le salari√©. La mensualisation permet d'√™tre pay√© selon un forfait mensuel ind√©pendant du nombre d'heures effectivement effectu√©es dans le mois."
            },
            {
                term: "Salaire de base",
                definition: "Montant de r√©mun√©ration fixe mentionn√©e dans le contrat de travail."
            },
            {
                term: "Salaire brut",
                definition: "Compos√© de variables. Ces derni√®res incluent le salaire de base mentionn√© dans le contrat de travail, les heures suppl√©mentaires ou compl√©mentaires (pour un temps partiel), les primes, les cong√©s pay√©s, ou encore les arr√™ts maladie."
            },
            {
                term: "Salaire net",
                definition: "S'obtient en partant du salaire brut et en d√©duisant les cotisations sociales."
            },
            {
                term: "Salaire net √† payer",
                definition: "Correspond √† la somme r√©ellement vers√©e au salari√©, apr√®s d√©duction des cotisations sociales salariales et du pr√©l√®vement √† la source de l'imp√¥t sur le revenu."
            },
            {
                term: "Salaire net √† payer avant imp√¥t sur le revenu",
                definition: "Montant du salaire brut, apr√®s d√©duction des cotisations sociales salariales et ajout de divers √©l√©ments tels que l'indemnit√© de transport ou les IJSS nettes."
            },
            {
                term: "Salaire net imposable",
                definition: "Montant utilis√© pour calculer l'imp√¥t sur le revenu. Il s'obtient en ajoutant au salaire net √† payer avant imp√¥t certains √©l√©ments imposables tels que la part des contributions CSG/CRDS imposable et la participation patronale √† la mutuelle."
            },
            {
                term: "Salari√©",
                definition: "D√©tient un contrat de travail √©tablissant la r√©alisation d'une t√¢che sp√©cifique, pour un montant donn√© et impliquant un lien de subordination."
            },
            {
                term: "Saisie sur salaire",
                definition: "Proc√©dure permettant √† un cr√©ancier de r√©cup√©rer des sommes dues directement sur le salaire du d√©biteur. La fraction saisissable est progressive et d√©pend du montant du salaire annuel."
            },
            {
                term: "Service Paie",
                definition: "Service charg√© principalement de la production des bulletins de paie et des d√©clarations sociales obligatoires."
            },
            {
                term: "Statut cadre",
                definition: "Cat√©gorie de salari√©s avec des responsabilit√©s importantes, b√©n√©ficiant de dispositions sp√©cifiques."
            }
        ];


        let currentQuestionIndex = 0; // Suit la question actuellement affich√©e
        let score = 0; // Stocke le score de l'utilisateur
        // Stocke l'index d'origine de la r√©ponse s√©lectionn√©e par l'utilisateur pour chaque question
        let userAnswers = new Array(quizData.questions.length).fill(null);
        // Suit si une question a √©t√© r√©pondue correctement √† la premi√®re tentative
        let answeredCorrectly = new Array(quizData.questions.length).fill(false);
        // Suit si le bonus pour la premi√®re tentative a d√©j√† √©t√© appliqu√© pour une question
        let firstAttemptBonusApplied = new Array(quizData.questions.length).fill(false);
        const BONUS_POINTS = 10; // Points √† attribuer pour une bonne r√©ponse √† la premi√®re tentative
        
        // Calcul de la dur√©e du quiz en fonction du nombre de questions (45 secondes par question)
        const QUIZ_DURATION_SECONDS_PER_QUESTION = 45;
        let QUIZ_DURATION_SECONDS; // Sera d√©fini en fonction du nombre de questions s√©lectionn√©
        
        let timerInterval;
        let timeLeft;

        let gameMode = 'normal'; // 'normal' ou 'survival'
        let lives = 3; // Pour le mode survie
        let soundEnabled = true; // √âtat pour l'activation/d√©sactivation du son

        // Contextes audio pour les effets sonores
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();

        function playCorrectSound() {
            if (!soundEnabled) return;
            // Son simple d'onde sinuso√Ødale pour une bonne r√©ponse
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();

            oscillator.type = 'sine';
            oscillator.frequency.setValueAtTime(880, audioContext.currentTime); // La5
            gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);

            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);

            oscillator.start();
            gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 0.5);
            oscillator.stop(audioContext.currentTime + 0.5);
        }

        function playIncorrectSound() {
            if (!soundEnabled) return;
            // Son simple d'onde en dents de scie pour une mauvaise r√©ponse
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();

            oscillator.type = 'sawtooth';
            oscillator.frequency.setValueAtTime(220, audioContext.currentTime); // La3
            gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);

            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);

            oscillator.start();
            gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 0.5);
            oscillator.stop(audioContext.currentTime + 0.5);
        }


        // Obtenir les r√©f√©rences aux √©l√©ments du DOM
        const quizContainer = document.querySelector('.quiz-container');
        let startScreen;
        let quizScreen;
        let resultsScreen;
        let reviewModeScreen;
        let glossaryScreen;
        let certificateScreen; // R√©f√©rence √† l'√©cran du certificat

        let startButton;
        let continueButton;
        let prevButton;
        let nextButton;
        let restartButton;
        let reviewButton;
        let backToResultsButton;
        let progressBar;
        let liveScoreDisplay;
        let correctProgressElement;
        let incorrectProgressElement;
        let unansweredProgressElement;
        let timerDisplay;
        let themeSwitcher;
        let soundToggle;
        let copyrightTextElement;
        let glossaryButtonStart;
        let glossaryButtonResults;
        let backToStartFromGlossary;
        let gameModeSelect;
        let numQuestionsSelect;
        let livesDisplay;
        let certificateButton; // Bouton du certificat
        let userNameInput;
        let printCertificateButton;
        let backToResultsFromCertificate;
        let certificateScoreElement;
        let certificateDateElement;


        // Fonction pour assigner les √©l√©ments du DOM apr√®s DOMContentLoaded
        function assignDOMElements() {
            startScreen = document.getElementById('startScreen');
            quizScreen = document.getElementById('quizScreen');
            resultsScreen = document.getElementById('resultsScreen');
            reviewModeScreen = document.getElementById('reviewModeScreen');
            glossaryScreen = document.getElementById('glossaryScreen');
            certificateScreen = document.getElementById('certificateScreen');

            startButton = document.getElementById('startButton');
            continueButton = document.getElementById('continueButton');
            prevButton = document.getElementById('prevButton');
            nextButton = document.getElementById('nextButton');
            restartButton = document.getElementById('restartButton');
            reviewButton = document.getElementById('reviewButton');
            backToResultsButton = document.getElementById('backToResultsButton');
            progressBar = document.getElementById('progressBar');
            liveScoreDisplay = document.getElementById('liveScoreDisplay');
            correctProgressElement = document.getElementById('correctProgress');
            incorrectProgressElement = document.getElementById('incorrectProgress');
            unansweredProgressElement = document.getElementById('unansweredProgress');
            timerDisplay = document.getElementById('timerDisplay');
            themeSwitcher = document.getElementById('themeSwitcher');
            soundToggle = document.getElementById('soundToggle');
            copyrightTextElement = document.getElementById('copyrightText');
            glossaryButtonStart = document.getElementById('glossaryButtonStart');
            glossaryButtonResults = document.getElementById('glossaryButtonResults');
            backToStartFromGlossary = document.getElementById('backToStartFromGlossary');
            gameModeSelect = document.getElementById('gameModeSelect');
            numQuestionsSelect = document.getElementById('numQuestionsSelect');
            livesDisplay = document.getElementById('livesDisplay');
            certificateButton = document.getElementById('certificateButton');
            userNameInput = document.getElementById('userNameInput');
            printCertificateButton = document.getElementById('printCertificateButton');
            backToResultsFromCertificate = document.getElementById('backToResultsFromCertificate');
            certificateScoreElement = document.getElementById('certificateScore');
            certificateDateElement = document.getElementById('certificateDate');
        }


        // --- Gestion du th√®me ---
        function applyTheme(theme) {
            if (theme === 'dark') {
                document.body.classList.add('dark-mode');
                localStorage.setItem('theme', 'dark');
            } else {
                document.body.classList.remove('dark-mode');
                localStorage.setItem('theme', 'light');
            }
            // Assure que tous les √©l√©ments dynamiques mettent √† jour leur classe de th√®me
            const allElements = document.querySelectorAll('h1, h2, p, .answer-option, .rationale, .button, .progress-bar, .live-score-display, .hint-text, .pre-choice-hint, .interactive-hint-display, .footer-links, .review-question-card, .glossary-term, #timerDisplay, .game-mode-selection label, .game-mode-selection select, .lives-display, .stats-text-color'); // Ajout de .stats-text-color
            allElements.forEach(element => {
                if (theme === 'dark') {
                    element.classList.add('dark-mode');
                } else {
                    element.classList.remove('dark-mode');
                }
            });

            // Ajustements sp√©cifiques des couleurs de texte pour le mode sombre
            const elementsToLighten = document.querySelectorAll(
                'h1, #startScreen p, #timerDisplay, #liveScoreDisplay, #reviewModeScreen h2, .footer-links p, .footer-links a, #copyrightText, .glossary-term h3, .glossary-term p, .game-mode-selection label, .game-mode-selection select, .lives-display, #certificateScreen h2, #certificateScreen p, #certificateScreen .signature, #certificateScreen input[type="text"], #certificateScreen .club-logo-text, #resultsScreen .score-display, #resultsScreen p, .stats-text-color' // Ajout de .stats-text-color
            );
            elementsToLighten.forEach(element => {
                if (theme === 'dark') {
                    element.classList.remove('text-gray-800', 'text-gray-700', 'text-gray-600', 'text-gray-500', 'text-blue-700', 'text-red-500');
                    element.classList.add('text-gray-100');
                    if (element.classList.contains('lives-display')) {
                        element.classList.add('text-red-300'); // Rouge plus clair pour les vies en mode sombre
                    }
                    if (element.classList.contains('text-blue-700')) { // Pour le nom du club sur l'√©cran de d√©marrage ou le score du certificat
                        element.classList.add('text-blue-300');
                    }
                    if (element.classList.contains('glossary-term') && element.tagName === 'P') { // Sp√©cifique pour le texte du paragraphe du glossaire
                        element.classList.add('text-gray-200');
                    }
                    if (element.classList.contains('stats-text-color')) { // Sp√©cifique pour le texte des statistiques
                        element.classList.add('text-fuchsia-300'); // Rose plus clair pour les stats en mode sombre
                    }
                } else {
                    element.classList.remove('text-gray-100', 'text-red-300', 'text-blue-300', 'text-fuchsia-300'); // Suppression des classes sp√©cifiques au mode sombre
                    // R√©applique les classes originales du mode clair si n√©cessaire, ou d√©finit une couleur fonc√©e par d√©faut
                    if (element.id === 'startScreen') {
                         element.classList.add('text-gray-700');
                    } else if (element.id === 'timerDisplay' || element.id === 'liveScoreDisplay') {
                        element.classList.add('text-gray-700');
                    } else if (element.tagName === 'H1' || element.tagName === 'H2') {
                        element.classList.add('text-gray-800');
                    } else if (element.classList.contains('footer-links')) {
                        element.classList.add('text-gray-700');
                    } else if (element.id === 'copyrightText') {
                        element.classList.add('text-gray-500');
                    } else if (element.classList.contains('glossary-term') && element.tagName === 'P') {
                        element.classList.add('text-gray-700'); // Fonc√© par d√©faut pour le texte du paragraphe du glossaire
                    } else if (element.classList.contains('glossary-term') && element.tagName === 'H3') {
                        element.classList.add('text-blue-700'); // Bleu par d√©faut pour le titre du glossaire
                    } else if (element.classList.contains('game-mode-selection')) {
                        element.classList.add('text-gray-700');
                    } else if (element.classList.contains('lives-display')) {
                        element.classList.add('text-red-500'); // Rouge par d√©faut pour les vies
                    } else if (element.parentElement && element.parentElement.id === 'certificateScreen') {
                        // Sp√©cifique pour le texte de l'√©cran du certificat
                        if (element.tagName === 'P' || element.tagName === 'INPUT') {
                            element.classList.add('text-gray-700');
                        } else if (element.classList.contains('signature')) {
                            element.classList.add('text-gray-800');
                        } else if (element.classList.contains('club-logo-text')) {
                            element.classList.add('text-blue-700');
                        }
                    } else if (element.parentElement && element.parentElement.id === 'resultsScreen') {
                        // Sp√©cifique pour le texte de l'√©cran des r√©sultats
                        if (element.classList.contains('score-display') || element.tagName === 'P') {
                            element.classList.add('text-gray-800'); // Assure un texte fonc√© en mode clair
                        }
                    } else if (element.classList.contains('stats-text-color')) { // Sp√©cifique pour le texte des statistiques
                        element.classList.add('text-pink-700'); // Rose fonc√© pour les stats en mode clair
                    }
                }
            });

            // Ajustement sp√©cifique pour le texte des boutons sociaux et le remplissage SVG
            const socialButtons = document.querySelectorAll('.discord-button, .whatsapp-button');
            socialButtons.forEach(button => {
                const svg = button.querySelector('svg');
                if (theme === 'dark') {
                    button.style.color = 'white'; // Force le texte blanc pour ces boutons en mode sombre
                    if (svg) svg.style.fill = 'white'; // Force le remplissage blanc pour l'ic√¥ne SVG
                } else {
                    button.style.color = ''; // R√©initialise √† la valeur par d√©faut (qui est blanc pour ces boutons en mode clair)
                    if (svg) svg.style.fill = 'currentColor'; // R√©initialise √† currentColor (h√©rite du texte)
                }
            });
        }

        function toggleTheme() {
            const currentTheme = localStorage.getItem('theme') || 'light';
            applyTheme(currentTheme === 'light' ? 'dark' : 'light');
        }


        // --- Stockage local de la progression ---
        function saveProgress() {
            const progress = {
                currentQuestionIndex,
                score,
                userAnswers,
                answeredCorrectly,
                firstAttemptBonusApplied,
                timeLeft,
                gameMode,
                lives,
                quizStarted: true, // Indique qu'un quiz a √©t√© d√©marr√©
                currentQuizQuestions: quizData.currentQuizQuestions // Sauvegarde le sous-ensemble de questions utilis√©
            };
            localStorage.setItem('quizProgress', JSON.stringify(progress));

            // Sauvegarde les statistiques historiques
            let stats = JSON.parse(localStorage.getItem('quizStats')) || {
                bestScore: 0,
                totalAttempts: 0,
                totalCorrectAnswersOverall: 0,
                totalQuestionsAnsweredOverall: 0
            };
            localStorage.setItem('quizStats', JSON.stringify(stats)); // Assure que les stats sont initialis√©es si non pr√©sentes
        }

        function loadProgress() {
            const savedProgress = localStorage.getItem('quizProgress');
            if (savedProgress) {
                const progress = JSON.parse(savedProgress);
                currentQuestionIndex = progress.currentQuestionIndex;
                score = progress.score;
                userAnswers = progress.userAnswers;
                answeredCorrectly = progress.answeredCorrectly;
                firstAttemptBonusApplied = progress.firstAttemptBonusApplied;
                timeLeft = progress.timeLeft;
                gameMode = progress.gameMode || 'normal'; // D√©finit le mode normal par d√©faut si non sauvegard√©
                lives = progress.lives !== undefined ? progress.lives : 3; // D√©finit 3 vies par d√©faut
                quizData.currentQuizQuestions = progress.currentQuizQuestions; // Charge le sous-ensemble de questions
                return progress.quizStarted;
            }
            return false;
        }

        function clearProgress() {
            localStorage.removeItem('quizProgress');
        }

        // --- Fonctions du minuteur ---
        function formatTime(seconds) {
            const minutes = Math.floor(seconds / 60);
            const remainingSeconds = seconds % 60;
            return `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
        }

        function updateTimerDisplay() {
            if (timerDisplay) { // V√©rifie si timerDisplay existe avant de le mettre √† jour
                timerDisplay.textContent = `Temps restant : ${formatTime(timeLeft)}`;
            }
            if (livesDisplay) { // V√©rifie si livesDisplay existe avant de le mettre √† jour
                if (gameMode === 'survival') {
                    livesDisplay.textContent = `Vies restantes : ${lives} ‚ù§Ô∏è`;
                    livesDisplay.classList.remove('hidden');
                    if (timerDisplay) timerDisplay.classList.add('hidden'); // Cache le minuteur en mode survie
                } else {
                    livesDisplay.classList.add('hidden');
                    if (timerDisplay) timerDisplay.classList.remove('hidden'); // Affiche le minuteur en mode normal
                }
            }
        }

        function startTimer() {
            clearInterval(timerInterval); // Efface tout minuteur existant
            if (gameMode === 'normal') {
                timerInterval = setInterval(() => {
                    timeLeft--;
                    updateTimerDisplay();
                    if (timeLeft <= 0) {
                        clearInterval(timerInterval);
                        showResults(true); // Indique que le quiz s'est termin√© par le temps
                    }
                }, 1000);
            }
            // Pas de minuteur pour le mode survie, les vies dictent la progression
        }

        function stopTimer() {
            clearInterval(timerInterval);
        }

        // --- Gestion du flux du quiz ---
        function showScreen(screenId) {
            // Assure que tous les √©l√©ments d'√©cran sont assign√©s avant d'essayer de les cacher
            // Ceci est crucial pour pr√©venir les erreurs "Cannot read properties of null"
            const screens = [
                document.getElementById('startScreen'),
                document.getElementById('quizScreen'),
                document.getElementById('resultsScreen'),
                document.getElementById('reviewModeScreen'),
                document.getElementById('glossaryScreen'),
                document.getElementById('certificateScreen')
            ];
            screens.forEach(screen => {
                if (screen) { // V√©rifie si l'√©l√©ment existe
                    screen.classList.add('hidden');
                }
            });

            const targetScreen = document.getElementById(screenId);
            if (targetScreen) {
                targetScreen.classList.remove('hidden');
            }
            
            // R√©applique le th√®me aux √©l√©ments nouvellement affich√©s
            applyTheme(localStorage.getItem('theme') || 'light');
        }

        function startQuiz(resume = false) {
            gameMode = gameModeSelect.value; // Obtient le mode s√©lectionn√© dans la liste d√©roulante
            let numQuestionsToUse = numQuestionsSelect.value;

            if (!resume) {
                currentQuestionIndex = 0;
                score = 0;
                userAnswers = new Array(quizData.questions.length).fill(null); // R√©initialise toutes les r√©ponses
                answeredCorrectly = new Array(quizData.questions.length).fill(false);
                firstAttemptBonusApplied = new Array(quizData.questions.length).fill(false);
                lives = 3; // R√©initialise les vies pour un nouveau quiz de survie
                clearProgress(); // Efface la progression pr√©c√©dente si on d√©marre √† z√©ro

                // M√©lange les questions et s√©lectionne un sous-ensemble si ce n'est pas "all"
                let shuffledQuizQuestions = [...quizData.questions];
                for (let i = shuffledQuizQuestions.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [shuffledQuizQuestions[i], shuffledQuizQuestions[j]] = [shuffledQuizQuestions[j], shuffledQuizQuestions[i]];
                }

                if (numQuestionsToUse !== 'all') {
                    numQuestionsToUse = parseInt(numQuestionsToUse, 10); // Convertir en entier
                    quizData.currentQuizQuestions = shuffledQuizQuestions.slice(0, numQuestionsToUse);
                } else {
                    quizData.currentQuizQuestions = shuffledQuizQuestions;
                }
                
                // Recalcule la dur√©e en fonction des questions r√©elles pour cette instance de quiz
                QUIZ_DURATION_SECONDS = quizData.currentQuizQuestions.length * QUIZ_DURATION_SECONDS_PER_QUESTION;
                timeLeft = QUIZ_DURATION_SECONDS;

            } else {
                // Si on reprend, quizData.currentQuizQuestions devrait d√©j√† √™tre d√©fini si c'√©tait un quiz de longueur personnalis√©e
                // Si c'est un quiz complet, quizData.currentQuizQuestions sera ind√©fini, donc on utilise quizData.questions
                if (!quizData.currentQuizQuestions) {
                    quizData.currentQuizQuestions = quizData.questions;
                }
                // Le minuteur 'timeLeft' et les 'lives' sont d√©j√† charg√©s √† partir de la progression sauvegard√©e
            }
            showScreen('quizScreen');
            startTimer();
            displayQuestion();
        }

        // Fonction pour m√©langer un tableau (algorithme de Fisher-Yates)
        // Modifi√© pour pr√©server l'index d'origine de chaque option
        function shuffleArray(array) {
            // Cr√©e une copie du tableau avec l'index d'origine
            let indexedArray = array.map((item, index) => ({ item, originalIndex: index }));
            for (let i = indexedArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [indexedArray[i], indexedArray[j]] = [indexedArray[j], indexedArray[i]]; 
            }
            return indexedArray;
        }

        // Fonction pour afficher la question actuelle et ses options
        function displayQuestion() {
            const questionsSource = quizData.currentQuizQuestions || quizData.questions; // Utilise currentQuizQuestions si d√©fini, sinon toutes les questions
            const questionData = questionsSource[currentQuestionIndex];
            // M√©lange les options en conservant leur index d'origine
            const shuffledOptionsWithOriginalIndex = shuffleArray([...questionData.answerOptions]);

            const quizDiv = document.getElementById('quiz');
            quizDiv.innerHTML = `
                <div class="question-text">${currentQuestionIndex + 1}. ${questionData.question}</div>
                ${questionData.preChoiceHint ? `<div id="preChoiceHint" class="pre-choice-hint">${questionData.preChoiceHint}</div>` : ''}
                <div id="answerOptions" class="flex flex-col gap-3">
                    ${shuffledOptionsWithOriginalIndex.map(optionWrapper => `
                        <div class="answer-option rounded-xl p-4 cursor-pointer transition-all duration-200 ease-in-out hover:bg-blue-100 hover:shadow-md"
                             data-original-index="${optionWrapper.originalIndex}"
                             onclick="selectAnswer(this, ${optionWrapper.originalIndex})">
                            ${optionWrapper.item.text}
                        </div>
                    `).join('')}
                </div>
                <div id="hint" class="hint-text hidden mt-4">Indice : ${questionData.hint}</div>
                <div id="rationaleContainer" class="mt-4 hidden"></div>
                <div id="bonusMessage" class="bonus-message hidden"></div> <!-- Nouveau div pour le message de bonus -->
                <div id="interactiveHintDisplay" class="interactive-hint-display hidden mt-4"></div> <!-- Nouveau div pour l'indice interactif -->
            `;

            // Si l'utilisateur a d√©j√† r√©pondu √† cette question, restaurer sa s√©lection et afficher la justification
            if (userAnswers[currentQuestionIndex] !== null) {
                const selectedOptionElement = quizDiv.querySelector(`[data-original-index="${userAnswers[currentQuestionIndex]}"]`);
                if (selectedOptionElement) {
                    // Appliquer la logique de showRationale pour restaurer les couleurs et justifications
                    showRationale(selectedOptionElement, userAnswers[currentQuestionIndex], false); // Ne pas recalculer le bonus si d√©j√† r√©pondu
                }
            } else {
                // S'assurer que les messages de bonus et d'indice interactif sont cach√©s pour une nouvelle question
                document.getElementById('bonusMessage').classList.add('hidden');
                document.getElementById('interactiveHintDisplay').classList.add('hidden');
            }

            updateNavigationButtons();
            updateProgressBar();
            updateLiveScoreDisplay();
            saveProgress(); // Sauvegarde la progression apr√®s l'affichage de la question
        }

        // Fonction pour g√©rer la s√©lection d'une r√©ponse par l'utilisateur
        function selectAnswer(selectedElement, originalSelectedIndex) {
            // Si la question a d√©j√† √©t√© r√©pondu, emp√™cher une nouvelle s√©lection
            if (userAnswers[currentQuestionIndex] !== null) {
                return;
            }

            // Stocker l'index D'ORIGINE de la r√©ponse s√©lectionn√©e
            userAnswers[currentQuestionIndex] = originalSelectedIndex;

            // Cacher l'indice avant le choix une fois qu'une r√©ponse est s√©lectionn√©e
            const preChoiceHintElement = document.getElementById('preChoiceHint');
            if (preChoiceHintElement) {
                preChoiceHintElement.classList.add('hidden');
            }

            // Appliquer la logique de showRationale pour afficher les couleurs et justifications
            showRationale(selectedElement, originalSelectedIndex, true); // Indiquer que c'est une nouvelle tentative pour le bonus
            saveProgress(); // Sauvegarde la progression apr√®s la s√©lection de la r√©ponse
        }

        // Fonction pour afficher la justification pour toutes les options et mettre √† jour le score
        function showRationale(selectedElement, originalSelectedIndex, isNewAttempt) {
            const questionsSource = quizData.currentQuizQuestions || quizData.questions;
            const questionData = questionsSource[currentQuestionIndex];
            const allOptionsElements = document.getElementById('quiz').querySelectorAll('.answer-option');
            const rationaleContainer = document.getElementById('rationaleContainer');
            const bonusMessageElement = document.getElementById('bonusMessage'); // R√©f√©rence au nouveau div
            const interactiveHintDisplay = document.getElementById('interactiveHintDisplay'); // R√©f√©rence au nouveau div pour l'indice interactif

            rationaleContainer.innerHTML = '';
            bonusMessageElement.classList.add('hidden'); // Cacher le message de bonus par d√©faut
            interactiveHintDisplay.classList.add('hidden'); // Cacher l'indice interactif par d√©faut

            let isCurrentAnswerCorrect = false; // Pour savoir si la r√©ponse s√©lectionn√©e est correcte

            allOptionsElements.forEach(optionElement => {
                const optionOriginalIndex = parseInt(optionElement.dataset.originalIndex);
                const optionData = questionData.answerOptions[optionOriginalIndex];
                const isCorrectOption = optionData.isCorrect;
                const rationaleText = optionData.rationale;

                // Nettoyer toutes les classes de couleur avant d'appliquer les nouvelles
                optionElement.classList.remove('selected', 'correct', 'incorrect');

                // Cr√©er un div pour la justification de chaque option
                const rationaleDiv = document.createElement('div');
                rationaleDiv.classList.add('rationale', 'rounded-lg', 'p-3', 'mb-2');
                rationaleDiv.innerHTML = `<strong>${optionElement.innerText}:</strong> ${rationaleText}`;

                // Logique de couleur pour les options de r√©ponse (l'√©l√©ment cliqu√© et les autres)
                if (optionOriginalIndex === originalSelectedIndex) {
                    // C'est l'option s√©lectionn√©e par l'utilisateur
                    optionElement.classList.add('selected'); // Jaune pour l'option s√©lectionn√©e
                    if (isCorrectOption) {
                        isCurrentAnswerCorrect = true;
                        // Si la r√©ponse s√©lectionn√©e est correcte, sa justification est bleue
                        rationaleDiv.classList.add('correct-rationale');
                    } else {
                        // Si la r√©ponse s√©lectionn√©e est incorrecte, sa justification est jaune
                        rationaleDiv.classList.add('selected-rationale');
                    }
                } else if (isCorrectOption) {
                    // C'est la bonne r√©ponse, mais non s√©lectionn√©e par l'utilisateur
                    optionElement.classList.add('correct'); // Bleu pour la bonne r√©ponse non s√©lectionn√©e
                    rationaleDiv.classList.add('correct-rationale'); // Bleu pour sa justification
                } else {
                    // C'est une mauvaise r√©ponse, non s√©lectionn√©e par l'utilisateur
                    optionElement.classList.add('incorrect'); // Fuchsia pour les mauvaises r√©ponses non s√©lectionn√©es
                    rationaleDiv.classList.add('incorrect-rationale'); // Fuchsia pour sa justification
                }

                rationaleContainer.appendChild(rationaleDiv);
            });

            // Mettre √† jour le score et le statut `answeredCorrectly`
            if (isNewAttempt) { // Seulement si c'est une nouvelle tentative
                if (isCurrentAnswerCorrect) {
                    score++; // Ajoute le point de la question
                    answeredCorrectly[currentQuestionIndex] = true;
                    if (!firstAttemptBonusApplied[currentQuestionIndex]) {
                        score += BONUS_POINTS; // Ajoute les points bonus
                        firstAttemptBonusApplied[currentQuestionIndex] = true;
                        bonusMessageElement.textContent = `Bien jou√© ! +${BONUS_POINTS} points bonus pour votre premi√®re tentative ! üéâ`;
                        bonusMessageElement.classList.add('success');
                        bonusMessageElement.classList.remove('hidden');
                    }
                    playCorrectSound(); // Joue le son pour une bonne r√©ponse
                } else {
                    if (gameMode === 'survival') {
                        lives--;
                        if (lives <= 0) {
                            showResults(false, true); // Termine le quiz en raison du manque de vies
                            return; // Arr√™te le traitement ult√©rieur
                        }
                    }
                    bonusMessageElement.textContent = `Pas de points bonus pour cette fois, mais continuez √† apprendre ! üí°`;
                    bonusMessageElement.classList.add('info');
                    bonusMessageElement.classList.remove('hidden');

                    // Afficher l'indice interactif si disponible et la r√©ponse est incorrecte
                    const interactiveHint = questionData.interactiveHint;
                    if (interactiveHint && interactiveHint.text) {
                        interactiveHintDisplay.textContent = interactiveHint.text;
                        interactiveHintDisplay.classList.remove('hidden');
                        interactiveHintDisplay.classList.add('fade-in'); // Ajoute la classe pour l'animation
                        // Supprime la classe d'animation apr√®s un court d√©lai pour permettre de la re-d√©clencher
                        setTimeout(() => {
                            interactiveHintDisplay.classList.remove('fade-in');
                        }, 500); // Correspond √† la dur√©e de l'animation
                    }
                    playIncorrectSound(); // Joue le son pour une mauvaise r√©ponse
                }
            }

            updateLiveScoreDisplay();
            updateProgressBar(); // Met √† jour la barre de progression apr√®s la s√©lection
            rationaleContainer.classList.remove('hidden');
            allOptionsElements.forEach(option => option.style.pointerEvents = 'none'); // D√©sactive les clics apr√®s la s√©lection
            nextButton.disabled = false;
        }

        // Fonction pour mettre √† jour l'√©tat des boutons de navigation (Pr√©c√©dent/Suivant)
        function updateNavigationButtons() {
            const questionsSource = quizData.currentQuizQuestions || quizData.questions;
            prevButton.disabled = currentQuestionIndex === 0;
            // Le bouton Suivant est d√©sactiv√© si la question actuelle n'a pas encore √©t√© r√©pondue
            nextButton.disabled = userAnswers[currentQuestionIndex] === null;
            nextButton.textContent = currentQuestionIndex === questionsSource.length - 1 ? 'Voir les r√©sultats' : 'Suivant';
        }

        // Fonction pour mettre √† jour la barre de progression color√©e
        function updateProgressBar() {
            const questionsSource = quizData.currentQuizQuestions || quizData.questions;
            const totalQuestions = questionsSource.length;
            let correctCount = 0;
            let incorrectCount = 0;
            let unansweredCount = 0;

            for (let i = 0; i < totalQuestions; i++) {
                // V√©rifie par rapport au tableau userAnswers qui a la longueur de quizData.questions d'origine
                // Nous devons mapper l'index de currentQuizQuestions √† l'index de quizData.questions d'origine pour obtenir la r√©ponse de l'utilisateur
                // Cette logique doit √™tre ajust√©e si userAnswers est toujours bas√© sur le quizData.questions complet d'origine.
                // Pour simplifier, supposons que userAnswers est r√©initialis√© et rempli en fonction des questions du quiz *actuel*.

                // Si une question a √©t√© r√©pondue dans le sous-ensemble actuel
                if (userAnswers[i] !== null) {
                    const originalOptionIndex = userAnswers[i]; // C'est l'index d'origine de l'option
                    const isCorrect = questionsSource[i].answerOptions[originalOptionIndex].isCorrect;
                    if (isCorrect) {
                        correctCount++;
                    } else {
                        incorrectCount++;
                    }
                } else {
                    unansweredCount++;
                }
            }

            const correctPercentage = (correctCount / totalQuestions) * 100;
            const incorrectPercentage = (incorrectCount / totalQuestions) * 100;
            unansweredPercentage = 100 - correctPercentage - incorrectPercentage; // Recalcule pour √©viter les probl√®mes de virgule flottante

            correctProgressElement.style.width = `${correctPercentage}%`;
            incorrectProgressElement.style.width = `${incorrectPercentage}%`;
            unansweredProgressElement.style.width = `${unansweredPercentage}%`;

            // Affiche les pourcentages √† l'int√©rieur des sections color√©es si > 0
            correctProgressElement.textContent = correctPercentage > 0 ? `${correctPercentage.toFixed(0)}%` : '';
            incorrectProgressElement.textContent = incorrectPercentage > 0 ? `${incorrectPercentage.toFixed(0)}%` : '';
            unansweredProgressElement.textContent = unansweredPercentage > 0 ? `${unansweredPercentage.toFixed(0)}%` : '';
        }

        // Fonction pour mettre √† jour l'affichage du score en direct
        function updateLiveScoreDisplay() {
            const questionsSource = quizData.currentQuizQuestions || quizData.questions;
            const totalQuestions = questionsSource.length;
            const currentQuestionNumber = currentQuestionIndex + 1;
            // Le score affich√© est le score total (points de base + bonus)
            liveScoreDisplay.textContent = `Score total : ${score} points - Question ${currentQuestionNumber} / ${totalQuestions}`;
            updateTimerDisplay(); // Met √©galement √† jour l'affichage des vies si en mode survie
        }

        // Fonction pour afficher les r√©sultats finaux du quiz
        function showResults(timeRanOut = false, noLivesLeft = false) {
            stopTimer(); // Arr√™te le minuteur lorsque les r√©sultats sont affich√©s
            showScreen('resultsScreen');

            const questionsSource = quizData.currentQuizQuestions || quizData.questions;
            const totalQuestions = questionsSource.length;
            let finalCorrectCountQuestions = 0; // Nombre de questions r√©pondues correctement
            let finalIncorrectCountQuestions = 0; // Nombre de questions r√©pondues incorrectement
            let finalUnansweredCountQuestions = 0; // Nombre de questions non r√©pondues

            for (let i = 0; i < totalQuestions; i++) {
                if (userAnswers[i] !== null) {
                    const originalOptionIndex = userAnswers[i];
                    const isCorrect = questionsSource[i].answerOptions[originalOptionIndex].isCorrect;
                    if (isCorrect) {
                        finalCorrectCountQuestions++;
                    } else {
                        finalIncorrectCountQuestions++;
                    }
                } else {
                    finalUnansweredCountQuestions++;
                }
            }

            const finalCorrectPercentageQuestions = ((finalCorrectCountQuestions / totalQuestions) * 100).toFixed(0);
            
            let feedbackMessage = "";
            let celebrationContent = "";
            let shareFeedbackMessage = ""; // Message sp√©cifique pour le partage

            if (timeRanOut) {
                feedbackMessage = `Le temps est √©coul√© ! Votre score final est de ${score} points.`;
                shareFeedbackMessage = `Le temps est √©coul√© ! J'ai eu ${finalCorrectPercentageQuestions}% de r√©ussite.`;
            } else if (noLivesLeft) {
                feedbackMessage = `Vous n'avez plus de vies ! Votre score final est de ${score} points.`;
                shareFeedbackMessage = `Plus de vies ! J'ai eu ${finalCorrectPercentageQuestions}% de r√©ussite.`;
            }
            else if (finalCorrectPercentageQuestions <= 25) {
                feedbackMessage = `Votre score de ${finalCorrectPercentageQuestions}% de r√©ussite est un bon d√©but. Il est temps de revoir vos cours ! Continuez votre apprentissage en pratiquant et en regardant les lives. C'est essentiel pour progresser. üìöüí°`;
                shareFeedbackMessage = `Mon r√©sultat est de ${finalCorrectPercentageQuestions}% de r√©ussite. Il est temps de revoir mes cours et de progresser !`;
            } else if (finalCorrectPercentageQuestions <= 50) {
                feedbackMessage = `Votre score de ${finalCorrectPercentageQuestions}% de r√©ussite est encourageant. C'est bien, continuez ainsi ! Le prochain palier est 75%. Pour y arriver, continuez √† progresser, suivez les lives, appliquez les concepts et faites de la veille sociale. üí™üöÄ`;
                shareFeedbackMessage = `Mon score est de ${finalCorrectPercentageQuestions}% de r√©ussite. C'est encourageant, mais je vise plus haut !`;
            } else if (finalCorrectPercentageQuestions <= 75) {
                feedbackMessage = `F√©licitations pour votre score de ${finalCorrectPercentageQuestions}% de r√©ussite ! Vos efforts portent leurs fruits. Vous pouvez continuer √† vous performer et viser l'excellence. üåüüéØ`;
                shareFeedbackMessage = `J'ai obtenu ${finalCorrectPercentageQuestions}% de r√©ussite ! Tr√®s bon score, je continue de m'am√©liorer !`;
            } else { // > 75% jusqu'√† 100%
                feedbackMessage = `F√©licitations pour votre score de ${finalCorrectPercentageQuestions}% de r√©ussite ! üéâüî• Vous ma√Ætrisez le sujet ! N'oubliez pas que nous sommes une √©quipe, motivez la troupe et le transfert de comp√©tences est important : aidez les autres personnes. üèÖüéì`;
                celebrationContent = `
                    <p class="text-2xl font-bold text-yellow-500 mt-4">üéâüî• M√âDAILLE D'OR ! üî•üéâ</p>
                    <p class="text-xl font-semibold text-blue-600">Dipl√¥me de Ma√Ætrise du R√®glement du Salaire !</p>
                `;
                shareFeedbackMessage = `J'ai atteint ${finalCorrectPercentageQuestions}% de r√©ussite ! C'est la f√™te ! Je suis pr√™t √† partager mes connaissances et √† motiver la troupe !`;
            }

            const resultsDiv = document.getElementById('resultsScreen');
            // Obtient le titre du quiz √† partir de la balise <title>
            const quizTitle = document.title;
            // Construit le message partageable pour Discord/WhatsApp
            const shareMessage = `Bonjour √† tous ! üëã J'ai termin√© le quiz "${quizTitle}" avec ${finalCorrectPercentageQuestions}% de r√©ussite (Score total : ${score} points). ${shareFeedbackMessage} Bonne journ√©e ! ‚ú®`;

            // Met √† jour les statistiques historiques
            let stats = JSON.parse(localStorage.getItem('quizStats')) || {
                bestScore: 0,
                totalAttempts: 0,
                totalCorrectAnswersOverall: 0,
                totalQuestionsAnsweredOverall: 0
            };

            stats.totalAttempts++;
            stats.totalCorrectAnswersOverall += finalCorrectCountQuestions;
            stats.totalQuestionsAnsweredOverall += totalQuestions;
            if (score > stats.bestScore) {
                stats.bestScore = score;
            }
            localStorage.setItem('quizStats', JSON.stringify(stats));

            const averageSuccessRate = stats.totalQuestionsAnsweredOverall > 0 ? ((stats.totalCorrectAnswersOverall / stats.totalQuestionsAnsweredOverall) * 100).toFixed(0) : 0;

            resultsDiv.innerHTML = `
                <div class="score-display">Votre score final : ${score} points sur un maximum de ${totalQuestions * (1 + BONUS_POINTS)} (base + bonus)</div>
                <p class="text-lg text-gray-700 mb-4">Questions correctement r√©pondues : ${finalCorrectCountQuestions} sur ${totalQuestions} (${finalCorrectPercentageQuestions}% de r√©ussite)</p>

                <div class="progress-bar final-results-chart-container">
                    <div class="progress-section correct-section" style="width: ${finalCorrectPercentageQuestions}%;">
                        ${finalCorrectPercentageQuestions > 0 ? `${finalCorrectPercentageQuestions}%` : ''}
                    </div>
                </div>

                <p class="text-xl font-semibold text-gray-800 mt-6">${feedbackMessage}</p>
                ${celebrationContent}

                <div class="mt-8 p-4 bg-gray-100 rounded-lg shadow-inner">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Vos Statistiques Personnelles</h3>
                    <p class="text-lg stats-text-color">Meilleur score : <span class="font-bold">${stats.bestScore}</span> points</p>
                    <p class="text-lg stats-text-color">Nombre de tentatives : <span class="font-bold">${stats.totalAttempts}</span></p>
                    <p class="text-lg stats-text-color">Taux de r√©ussite moyen : <span class="font-bold">${averageSuccessRate}%</span></p>
                </div>

                <div class="mt-8 p-4 bg-gray-100 rounded-lg shadow-inner">
                    <p class="text-lg font-semibold text-gray-700 mb-2">Partagez vos r√©sultats et √©changez !</p>
                    <textarea id="shareableResult" class="w-full p-2 border rounded-md text-gray-700 bg-gray-50 mb-4" rows="4" readonly>${shareMessage}</textarea>
                    <button id="copyResultButton" class="button bg-green-500 hover:bg-green-600 mb-4">Copier le message de partage</button>
                    <p class="text-md text-gray-600 mb-2">Rejoignez la discussion sur :</p>
                    <a href="https://discord.gg/cBnBkGDFgk" target="_blank" class="inline-block mt-2 bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-lg transition duration-300">
                        Discord üî• Payroll Boss Elite Club : Le Hub Paie & Progr√®s üìà
                    </a>
                    <a href="https://chat.whatsapp.com/EtV0ux5ipAG5JDhopzo0ut" target="_blank" class="inline-block mt-2 ml-2 bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition duration-300">
                        WhatsApp üî• | Payroll Boss Elite Club üëë| Infos & Actus
                    </a>
                </div>
                <button id="reviewButton" class="button mt-6">Revoir les r√©ponses</button>
                <button id="restartButton" class="button mt-6 ml-4">Recommencer le Quiz</button>
                <button id="glossaryButtonResults" class="button mt-6 ml-4 bg-gray-600 hover:bg-gray-700">Glossaire</button>
                <button id="certificateButton" class="button mt-6 ml-4 bg-yellow-500 hover:bg-yellow-600 ${finalCorrectPercentageQuestions >= 75 ? '' : 'hidden'}">Voir mon Certificat</button>
            `;

            // R√©attache les √©couteurs d'√©v√©nements pour les boutons de l'√©cran des r√©sultats
            document.getElementById('copyResultButton').addEventListener('click', () => {
                const shareableResult = document.getElementById('shareableResult');
                shareableResult.select();
                document.execCommand('copy');
                shareableResult.style.borderColor = '#10B981';
                shareableResult.style.boxShadow = '0 0 0 2px #10B981';
                setTimeout(() => {
                    shareableResult.style.borderColor = '';
                    shareableResult.style.boxShadow = '';
                }, 1500);
            });
            document.getElementById('reviewButton').addEventListener('click', showReviewMode);
            document.getElementById('restartButton').addEventListener('click', restartQuiz);
            document.getElementById('glossaryButtonResults').addEventListener('click', showGlossary);
            if (finalCorrectPercentageQuestions >= 75) {
                document.getElementById('certificateButton').addEventListener('click', showCertificate);
            }
            applyTheme(localStorage.getItem('theme') || 'light'); // R√©applique le th√®me au nouveau contenu des r√©sultats
        }

        // --- Fonctions du mode r√©vision ---
        function showReviewMode() {
            showScreen('reviewModeScreen');
            const reviewQuestionsContainer = document.getElementById('reviewQuestionsContainer');
            reviewQuestionsContainer.innerHTML = ''; // Efface le contenu pr√©c√©dent

            const questionsSource = quizData.currentQuizQuestions || quizData.questions; // Utilise les questions r√©elles utilis√©es dans l'instance du quiz

            questionsSource.forEach((questionData, index) => {
                const userAnswerIndex = userAnswers[index]; // Le tableau userAnswers correspond √† l'index de questionsSource
                const isAnswered = userAnswerIndex !== null;
                const userAnswerText = isAnswered ? questionData.answerOptions[userAnswerIndex].text : "Non r√©pondu";
                const isCorrect = isAnswered ? questionData.answerOptions[userAnswerIndex].isCorrect : false;
                const correctAnswerText = questionData.answerOptions.find(opt => opt.isCorrect).text;
                // Justification de secours si l'utilisateur n'a pas r√©pondu ou a choisi une option sans justification sp√©cifique
                const rationaleText = questionData.answerOptions[userAnswers[index]]?.rationale || questionData.answerOptions.find(opt => opt.isCorrect).rationale;


                const questionCard = document.createElement('div');
                questionCard.classList.add('review-question-card', 'rounded-xl', 'p-4', 'mb-4', 'shadow-md');
                // Applique la classe du mode sombre si le corps l'a
                if (document.body.classList.contains('dark-mode')) {
                    questionCard.classList.add('dark-mode');
                }

                questionCard.innerHTML = `
                    <div class="question-text">${index + 1}. ${questionData.question}</div>
                    <p class="user-answer">
                        <span class="result-icon">${isAnswered ? (isCorrect ? '‚úÖ' : '‚ùå') : '‚ùì'}</span>
                        Votre r√©ponse : ${userAnswerText}
                    </p>
                    <p class="correct-answer">
                        Bonne r√©ponse : ${correctAnswerText}
                    </p>
                    <div class="rationale">
                        <strong>Raisonnement :</strong> ${rationaleText}
                    </div>
                `;
                reviewQuestionsContainer.appendChild(questionCard);
            });
        }

        // --- Fonctions du glossaire ---
        function showGlossary() {
            showScreen('glossaryScreen');
            const glossaryContent = document.getElementById('glossaryContent');
            glossaryContent.innerHTML = ''; // Efface le contenu pr√©c√©dent

            glossaryData.sort((a, b) => a.term.localeCompare(b.term)); // Trie par ordre alphab√©tique

            glossaryData.forEach(item => {
                const termDiv = document.createElement('div');
                termDiv.classList.add('glossary-term', 'rounded-xl', 'p-3', 'mb-3');
                if (document.body.classList.contains('dark-mode')) {
                    termDiv.classList.add('dark-mode');
                }
                termDiv.innerHTML = `
                    <h3>${item.term}</h3>
                    <p>${item.definition}</p>
                `;
                glossaryContent.appendChild(termDiv);
            });
        }

        // --- Fonctions du certificat ---
        function showCertificate() {
            showScreen('certificateScreen');
            const certificateScoreElement = document.getElementById('certificateScore');
            const certificateDateElement = document.getElementById('certificateDate');
            const userNameInput = document.getElementById('userNameInput');

            certificateScoreElement.textContent = `${score} points`;
            certificateDateElement.textContent = new Date().toLocaleDateString('fr-FR', { year: 'numeric', month: 'long', day: 'numeric' });

            // Charge le nom d'utilisateur sauvegard√© si existe
            const savedUserName = localStorage.getItem('userName');
            if (savedUserName) {
                userNameInput.value = savedUserName;
            }

            // Sauvegarde le nom d'utilisateur lors du changement d'entr√©e
            userNameInput.addEventListener('input', () => {
                localStorage.setItem('userName', userNameInput.value);
            });

            document.getElementById('printCertificateButton').addEventListener('click', printCertificate);
            document.getElementById('backToResultsFromCertificate').addEventListener('click', () => showResults(false));
            applyTheme(localStorage.getItem('theme') || 'light'); // R√©applique le th√®me au contenu du certificat
        }

        function printCertificate() {
            // Cr√©e une nouvelle fen√™tre/onglet pour l'impression
            const printWindow = window.open('', '_blank');
            printWindow.document.write('<!DOCTYPE html>');
            printWindow.document.write('<html lang="fr"><head><title>Certificat de R√©ussite</title>');
            // Copie les styles CSS pertinents pour l'impression
            printWindow.document.write('<style>');
            printWindow.document.write(`
                body {
                    font-family: 'Inter', sans-serif;
                    margin: 0;
                    padding: 0;
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    min-height: 100vh;
                    background-color: white; /* Force blanc pour l'impression */
                    color: black; /* Force texte noir */
                }
                .certificate-print-container {
                    width: 210mm; /* Largeur A4 */
                    height: 297mm; /* Hauteur A4 */
                    padding: 20mm;
                    border: 5mm solid #c2185b; /* Bordure rose fonc√© */
                    box-shadow: 0 0 0 10px #f48fb1; /* Ombre rose claire */
                    display: flex;
                    flex-direction: column;
                    justify-content: center;
                    align-items: center;
                    text-align: center;
                    box-sizing: border-box;
                    position: relative;
                }
                .certificate-print-container h2 {
                    font-size: 2.5rem;
                    font-weight: 700;
                    color: #1d4ed8; /* Bleu profond */
                    margin-bottom: 20px;
                }
                .certificate-print-container p {
                    font-size: 1.2rem;
                    margin-bottom: 10px;
                    color: #4a5568;
                }
                .certificate-print-container .user-name {
                    font-size: 2.5rem; /* Nom plus grand */
                    font-weight: bold;
                    color: #c2185b; /* Rose fonc√© pour le nom */
                    margin: 10px 0 20px 0;
                    border-bottom: 2px solid #c2185b; /* Soulignement */
                    padding-bottom: 5px;
                    display: inline-block; /* Pour que la bordure s'adapte au texte */
                }
                .certificate-print-container .score-text {
                    font-size: 1.8rem;
                    font-weight: 600;
                    color: #4a5568;
                }
                .certificate-print-container .score-value {
                    font-size: 3.5rem; /* Score tr√®s grand */
                    font-weight: bold;
                    color: #1d4ed8; /* Bleu profond */
                    margin: 10px 0;
                }
                .certificate-print-container .date-text {
                    font-size: 1.1rem;
                    color: #4a5568;
                    margin-top: 20px;
                }
                .certificate-print-container .club-logo-text {
                    font-size: 1.8rem; /* Logo texte plus grand */
                    font-weight: bold;
                    color: #c2185b; /* Rose fonc√© */
                    margin-top: 40px;
                }
                .certificate-print-container .signature {
                    margin-top: 30px;
                    font-style: italic;
                    font-weight: 600;
                    font-size: 1.3rem;
                    color: #333; /* Gris fonc√© pour la signature */
                }
                /* Masquer les √©l√©ments non pertinents pour l'impression */
                .certificate-print-container button,
                .certificate-print-container input {
                    display: none !important;
                }
            `);
            printWindow.document.write('</style>');
            printWindow.document.write('</head><body>');

            // Contenu du certificat pour l'impression
            const userName = userNameInput.value || 'Nom non sp√©cifi√©';
            const scoreValue = certificateScoreElement.textContent;
            const dateValue = certificateDateElement.textContent;

            printWindow.document.write(`
                <div class="certificate-print-container">
                    <h2>Certificat de R√©ussite</h2>
                    <p>Ce certificat est d√©cern√© √†</p>
                    <p class="user-name">${userName}</p>
                    <p class="score-text">pour avoir compl√©t√© le Quiz sur la Pr√©sentation de la Gestion de la Paie avec un score de</p>
                    <p class="score-value">${scoreValue}</p>
                    <p class="date-text">en date du ${dateValue}</p>
                    <p class="club-logo-text">üî•Payroll Boss Elite Club üëë</p>
                    <p class="signature">‚ú®√ânervante √ânervante ü•≥</p>
                </div>
            `);

            printWindow.document.write('</body></html>');
            printWindow.document.close();
            printWindow.print();
        }


        // --- √âcouteurs d'√©v√©nements ---
        // Enveloppe l'assignation des √©couteurs d'√©v√©nements dans DOMContentLoaded pour s'assurer que les √©l√©ments existent
        document.addEventListener('DOMContentLoaded', () => {
            assignDOMElements(); // Assigne les √©l√©ments une fois que le DOM est pr√™t

            // D√©finit l'ann√©e actuelle dans le pied de page (d√©plac√© ici pour s'assurer que copyrightTextElement est disponible)
            document.getElementById('currentYear').textContent = new Date().getFullYear();
            copyrightTextElement.textContent = `üî•Payroll Boss Elite Club üëë. Tous droits r√©serv√©s.`; // REMPLACEZ PAR VOTRE TEXTE DE COPYRIGHT D√âFINITIF


            themeSwitcher.addEventListener('click', toggleTheme);
            soundToggle.addEventListener('click', () => {
                soundEnabled = !soundEnabled;
                soundToggle.textContent = soundEnabled ? 'üîä Muet' : 'üîá Activer son';
                localStorage.setItem('soundEnabled', soundEnabled); // Sauvegarde la pr√©f√©rence sonore
            });

            startButton.addEventListener('click', () => startQuiz(false));
            continueButton.addEventListener('click', () => startQuiz(true));
            glossaryButtonStart.addEventListener('click', showGlossary); // √âcouteur d'√©v√©nement pour le bouton du glossaire sur l'√©cran de d√©marrage
            

            nextButton.addEventListener('click', () => {
                const questionsSource = quizData.currentQuizQuestions || quizData.questions;
                if (currentQuestionIndex < questionsSource.length - 1) {
                    currentQuestionIndex++; // Passe √† la question suivante
                    displayQuestion(); // Affiche la nouvelle question
                } else {
                    showResults(); // Si c'est la derni√®re question, affiche les r√©sultats
                }
            });

            prevButton.addEventListener('click', () => {
                if (currentQuestionIndex > 0) {
                    currentQuestionIndex--; // Revient √† la question pr√©c√©dente
                    displayQuestion(); // Affiche la nouvelle question
                } else {
                    // Si sur la premi√®re question et essaie de revenir en arri√®re, r√©affiche simplement
                    displayQuestion();
                }
            });

            restartButton.addEventListener('click', restartQuiz);
            reviewButton.addEventListener('click', showReviewMode);
            backToResultsButton.addEventListener('click', () => showResults(false)); // Revient √† l'√©cran des r√©sultats
            backToStartFromGlossary.addEventListener('click', loadInitialState); // Revient du glossaire √† l'√©cran de d√©marrage

            // Chargement initial de l'√©tat du quiz
            loadInitialState();
        });


        function restartQuiz() {
            clearProgress();
            currentQuestionIndex = 0; // R√©initialise l'index de la question
            score = 0; // R√©initialise le score
            userAnswers = new Array(quizData.questions.length).fill(null); // R√©initialise toutes les r√©ponses √† null
            answeredCorrectly.fill(false); // R√©initialise le suivi de la justesse
            firstAttemptBonusApplied.fill(false); // R√©initialise le suivi du bonus
            timeLeft = QUIZ_DURATION_SECONDS; // R√©initialise le minuteur
            lives = 3; // R√©initialise les vies
            stopTimer(); // S'assure que le minuteur est arr√™t√©
            updateTimerDisplay(); // Met √† jour l'affichage
            loadInitialState(); // Affiche l'√©cran de d√©marrage avec un √©tat frais
        }

        // --- √âtat de chargement initial ---
        function loadInitialState() {
            // Charge la pr√©f√©rence sonore
            const savedSoundEnabled = localStorage.getItem('soundEnabled');
            if (savedSoundEnabled !== null) {
                soundEnabled = JSON.parse(savedSoundEnabled);
            }
            if (soundToggle) { // V√©rifie si soundToggle existe avant de le mettre √† jour
                soundToggle.textContent = soundEnabled ? 'üîä Muet' : 'üîá Activer son';
            }

            // Assure que le s√©lecteur de mode de jeu refl√®te le mode charg√©
            if (gameModeSelect) { // V√©rifie si gameModeSelect existe avant de le mettre √† jour
                gameModeSelect.value = gameMode;
            }
            // Assure que le s√©lecteur du nombre de questions refl√®te le total disponible ou la pr√©f√©rence sauvegard√©e
            if (numQuestionsSelect) { // V√©rifie si numQuestionsSelect existe avant de le mettre √† jour
                numQuestionsSelect.value = quizData.currentQuizQuestions ? quizData.currentQuizQuestions.length : 'all';
            }
            
            if (loadProgress()) {
                // S'il y a une progression sauvegard√©e, affiche le bouton Continuer
                if (continueButton) continueButton.classList.remove('hidden');
                updateTimerDisplay(); // Affiche le temps et les vies sauvegard√©s
            } else {
                // Pas de progression sauvegard√©e, cache le bouton Continuer
                if (continueButton) continueButton.classList.add('hidden');
                // Initialise pour un nouveau d√©part bas√© sur "toutes" les questions par d√©faut
                quizData.currentQuizQuestions = quizData.questions; // Par d√©faut, toutes les questions
                QUIZ_DURATION_SECONDS = quizData.currentQuizQuestions.length * QUIZ_DURATION_SECONDS_PER_QUESTION;
                timeLeft = QUIZ_DURATION_SECONDS;
                lives = 3; // R√©initialise les vies si pas de progression
                updateTimerDisplay(); // Affiche le temps et les vies initiaux
            }
            showScreen('startScreen');
        }
    </script>
</body>
</html>